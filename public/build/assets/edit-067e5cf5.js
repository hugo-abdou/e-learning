import{_ as A}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-b0d0d4a8.js";import{_ as I}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-fd46e006.js";import{d as P,c7 as W,l as $,m as q,r as m,c4 as J,o as p,h as v,f as o,b as t,q as r,b4 as h,c as M,j as O,F as G,c8 as H,am as C,k as w,e as x,V as K,y as Q,a4 as k,z as X}from"./main-de81c04a.js";import{u as Y}from"./useCourseStore-458c7fca.js";import{a as y,V as Z}from"./VRow-712fdf8b.js";import{V as ee,a as te,b as S,c as ae}from"./VWindowItem-74310388.js";import{V as oe}from"./VContainer-b6ce9bc4.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-1ad539a5.js";import"./VCheckboxBtn-a8607aa9.js";import"./VSelectionControl-18614d5a.js";import"./VInput-b77c619e.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-d0874295.js";import"./VTextField-687a8006.js";import"./VField-cd3a8674.js";import"./lodash-5f4e712f.js";import"./preact.module-7f17e2b0.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-5436e5d8.js";import"./VTooltip-3bc1a349.js";import"./ActionButton-7996e9d4.js";import"./validators-3b3891f3.js";import"./useQuizzesStore-e152037b.js";import"./VExpansionPanel-b89eeb00.js";import"./VForm-5850c8d7.js";import"./VMenu-e0abccb1.js";import"./VList-2584110e.js";import"./ssrBoot-7790c7e6.js";import"./VDivider-faf1c2d7.js";import"./VSelect-d4ff51fd.js";import"./VSwitch-b42882ed.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-c9bff932.js";import"./VTextarea-eeb9225e.js";import"./VSlideGroup-37f5fce8.js";const re={class:"d-flex gap-2 justify-space-between mt-8"},Ae=P({__name:"edit",setup(se){const g=W(),B=$(),N=q(),V=Y(),i=m(0),d=m("list"),f=m([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),l=m(),_=m([]);J(async()=>{var n,a,u;try{l.value=await V.getCourse(Number((n=B.params)==null?void 0:n.id),{additional:{chapters:!0}}),_.value=((a=l.value)==null?void 0:a.chapters)||[],delete l.value.chapters,(u=l.value)==null||delete u.author}catch{N.push({name:"course"})}});const F=async()=>{var a,u;const n=f.value[i.value];try{if(n.title.toLocaleLowerCase()==="details"&&l.value){const s=await((a=n.component)==null?void 0:a.validate());V.updateCourse(l.value.id,s)}if(n.title.toLocaleLowerCase()==="chapters"&&l.value){const s=await((u=n.component)==null?void 0:u.validate()),e=l.value.id,L=s.map((c,T)=>{const b={};return c.attachments.forEach(({name:D,id:R,type:E,download:U,visibility:j,watermark:z})=>{b[R]={name:D,type:E,download:U,visibility:JSON.stringify(j),watermark:z}}),{...c,course_id:e,attachments:b,order:T}});await Promise.all(L.map(c=>V.updateChapter(c.id||0,c))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(s){g.add({text:s==null?void 0:s.message,color:"error",timeout:5e3})}};return(n,a)=>{const u=I,s=A;return p(),v(oe,null,{default:o(()=>[t(Z,{align:"center"},{default:o(()=>[t(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:o(()=>[t(ee,{modelValue:r(i),"onUpdate:modelValue":a[0]||(a[0]=e=>h(i)?i.value=e:null),class:"v-tabs-pill"},{default:o(()=>[(p(!0),M(G,null,O(r(f),e=>(p(),v(ae,{key:e.icon},{default:o(()=>[t(k,{size:18,icon:e.icon,class:"me-1"},null,8,["icon"]),x("span",null,X(e.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(i)===1?(p(),v(y,{key:0},{default:o(()=>[t(H,{modelValue:r(d),"onUpdate:modelValue":a[1]||(a[1]=e=>h(d)?d.value=e:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:o(()=>[t(C,{value:"list",icon:"mdi-list-box-outline"}),t(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),t(y,{cols:"12"},{default:o(()=>[t(te,{modelValue:r(i),"onUpdate:modelValue":a[2]||(a[2]=e=>h(i)?i.value=e:null),class:"mt-5 overflow-visible"},{default:o(()=>[t(S,null,{default:o(()=>[t(u,{ref:e=>r(f)[0].component=e,course:r(l)},null,8,["course"])]),_:1}),t(S,null,{default:o(()=>[r(_)?(p(),v(s,{key:0,ref:e=>r(f)[1].component=e,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",re,[t(K),t(C,{color:"success",onClick:F},{default:o(()=>[Q(" Save "),t(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{Ae as default};
