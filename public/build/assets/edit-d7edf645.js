import{_ as L}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-b1a877fd.js";import{_ as N}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-4f8d9238.js";import{u as R}from"./useCourseStore-925d065a.js";import{d as E,d4 as T,s as W,t as m,a7 as j,o as d,f as V,B as a,y as t,at as A,au as h,e as l,ak as C,i as I,F as P,j as U,ah as w,w as b,D as $,E as z,ai as M,as as q,aW as y}from"./main-6856e496.js";import{b as G,c as H,V as J,a as k}from"./VWindowItem-78145d21.js";import{V as K}from"./VSpacer-6c1ac7c1.js";import{V as O}from"./VContainer-04b439fa.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-e4bbeb16.js";import"./GalleryView.vue_vue_type_script_setup_true_lang-27e7cfff.js";import"./utils-3e673e05.js";import"./VChip-bb22c723.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-24a58000.js";import"./VInput-05f64f58.js";import"./VTextField-3f8fbc0a.js";import"./VCheckbox-de9fcfb8.js";import"./VCheckboxBtn-a53b3bbd.js";import"./lodash-9761b882.js";import"./validators-f52bbb1d.js";import"./VExpansionPanel-62a31f2b.js";import"./VTooltip-4a77e37d.js";import"./VDivider-42d2cf99.js";import"./VForm-3c4b92a0.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-29d1b390.js";import"./VList-83a806ee.js";import"./ssrBoot-4fa9a4ce.js";import"./VMenu-02b0b56f.js";import"./VSwitch-6d3d89c5.js";import"./VSlideGroup-1ea281a1.js";const Q={class:"d-flex justify-space-between mt-8"},X=E({__name:"edit",setup(Y){const B=T(),S=W(),f=R(),n=m(0),p=m([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),r=m(),_=m([]);j(async()=>{var s,o,i;try{r.value=await f.getCourse(Number(B.params.id),{additional:{chapters:!0}}),_.value=((s=r.value)==null?void 0:s.chapters)||[],(o=r.value)==null||delete o.chapters,(i=r.value)==null||delete i.author}catch{S.push({name:"course"})}});const g=async()=>{var o,i;const s=p.value[n.value];try{if(s.title.toLocaleLowerCase()==="details"&&r.value){const c=await((o=s.component)==null?void 0:o.validate());f.updateCourse(r.value.id,c)}if(s.title.toLocaleLowerCase()==="chapters"&&r.value){const c=await((i=s.component)==null?void 0:i.validate()),e=r.value.id,x=c.map((u,D)=>{var v;return{...u,course_id:e,video:((v=u.video)==null?void 0:v.id)||null,documents:u.documents.map(({id:F})=>F),order:D}});await Promise.all(x.map(u=>f.updateChapter(u.id,u)))}}catch{}};return(s,o)=>{const i=N,c=L;return d(),V(O,null,{default:a(()=>[t(A,{align:"center"},{default:a(()=>[t(h,{cols:"12"},{default:a(()=>[t(G,{modelValue:l(n),"onUpdate:modelValue":o[0]||(o[0]=e=>C(n)?n.value=e:null),class:"v-tabs-pill"},{default:a(()=>[(d(!0),I(P,null,U(l(p),e=>(d(),V(H,{key:e.icon},{default:a(()=>[t(w,{size:18,icon:e.icon,class:"me-1"},null,8,["icon"]),b("span",null,$(e.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),t(h,{cols:"12"},{default:a(()=>[t(J,{modelValue:l(n),"onUpdate:modelValue":o[1]||(o[1]=e=>C(n)?n.value=e:null),class:"mt-5"},{default:a(()=>[t(k,null,{default:a(()=>[t(i,{course:l(r),ref:e=>l(p)[0].component=e},null,8,["course"])]),_:1}),t(k,null,{default:a(()=>[l(_)?(d(),V(c,{key:0,chapters:l(_),ref:e=>l(p)[1].component=e},null,8,["chapters"])):z("",!0)]),_:1})]),_:1},8,["modelValue"]),b("div",Q,[t(K),t(M,{color:"success",onClick:g},{default:a(()=>[q(" Save "),t(w,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});typeof y=="function"&&y(X);export{X as default};
