import{_ as Z}from"./AppTextField.vue_vue_type_script_setup_true_lang-2f8d64a7.js";import{_ as ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-2d20289e.js";import{d as Q,t as d,au as J,L as G,o as h,f as A,B as t,y as e,aF as H,aQ as K,e as l,ah as b,aJ as ae,aq as R,ar as w,af as $,ap as V,aR as le,a8 as I,aS as te,r as se,i as N,w as _,D as c,aI as oe,aT as re,aP as ne,F as ie,j as de,E as L,aU as ue,m as M,aV as j}from"./main-0fb5c6c1.js";import{u as W}from"./useUserListStore-fad586e5.js";import{r as S,e as me}from"./validators-f52bbb1d.js";import{_ as X}from"./RolesSelectBox.vue_vue_type_script_setup_true_lang-f2d84315.js";import{V as pe}from"./VForm-9682cdf4.js";import{V as O}from"./VTextField-532f6e97.js";import{a as fe}from"./formatters-2598f6f8.js";import{l as ce}from"./lodash-f161a86d.js";import{V as E}from"./VDivider-840de6e4.js";import{V as ve}from"./VDataTableServer-648ecd78.js";import{V as Ve}from"./VChip-3b2a7de1.js";import{V as we}from"./VMenu-0d165f1d.js";import{V as ge,a as z,b as q}from"./VList-48ccb2a7.js";import{V as _e}from"./VPagination-765357c7.js";import"./VInput-e0df6d44.js";import"./VSelect-4aaf1ab0.js";import"./VCheckboxBtn-519cbdc3.js";import"./VTable-2bbef517.js";const be=Q({__name:"AddNewUserDrawer",props:{isDrawerOpen:{type:Boolean,default:!1},brand:null,disabledRoles:{type:Boolean},defaultRoles:null},emits:["update:isDrawerOpen","userData"],setup(T,{emit:y}){const p=T,f=d(!1),g=d(!1),C=d(!1),m=d(),U=d(""),D=d(""),s=d(""),x=d(),v=d({name:void 0,email:void 0,password:void 0}),B=()=>{I(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation(),v.value={name:void 0,email:void 0,password:void 0}})},P=()=>{y("update:isDrawerOpen",!1),k.refreshUser(),I(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation()})},F=W(),i=()=>{var r;g.value=!0,(r=m.value)==null||r.validate().then(async({valid:n})=>{if(n){try{const a=await F.addUser({name:U.value,email:D.value,role:[],password:s.value,password_confirmation:s.value,terms:!0});y("userData",a.data),y("update:isDrawerOpen",!1),B()}catch(a){a.response.status===422&&(v.value=a.response.data.errors)}g.value=!1}})},o=r=>{y("update:isDrawerOpen",r)},k=J();return G(()=>p.isDrawerOpen,r=>{p.defaultRoles&&(x.value=p.defaultRoles)}),(r,n)=>{const a=te;return h(),A(le,{width:r.$vuetify.display.smAndDown?"auto":677,"model-value":p.isDrawerOpen,"onUpdate:modelValue":o},{default:t(()=>[e(a,{onClick:P}),e(H,{title:"Create New User",subtitle:"Created user details will receive a privacy audit."},{default:t(()=>[e(K,null,{default:t(()=>[e(pe,{ref_key:"refForm",ref:m,modelValue:l(C),"onUpdate:modelValue":n[5]||(n[5]=u=>b(C)?C.value=u:null),onSubmit:ae(i,["prevent"])},{default:t(()=>[e(R,null,{default:t(()=>[e(w,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(U),"onUpdate:modelValue":n[0]||(n[0]=u=>b(U)?U.value=u:null),rules:[l(S)],label:"Full Name","error-messages":l(v).name},null,8,["modelValue","rules","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(D),"onUpdate:modelValue":n[1]||(n[1]=u=>b(D)?D.value=u:null),rules:[l(S),l(me)],label:"Email","error-messages":l(v).email},null,8,["modelValue","rules","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(s),"onUpdate:modelValue":n[2]||(n[2]=u=>b(s)?s.value=u:null),label:"Password",rules:[l(S)],type:l(f)?"text":"password","append-inner-icon":l(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":n[3]||(n[3]=u=>f.value=!l(f)),"error-messages":l(v).password},null,8,["modelValue","rules","type","append-inner-icon","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:t(()=>[e(X,{rules:[l(S)],modelValue:l(x),"onUpdate:modelValue":n[4]||(n[4]=u=>b(x)?x.value=u:null)},null,8,["rules","modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e($,{type:"submit",class:"me-3",loading:l(g),disabled:l(g)},{default:t(()=>[V(" Submit ")]),_:1},8,["loading","disabled"]),e($,{type:"reset",variant:"tonal",color:"secondary",onClick:P},{default:t(()=>[V(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),ye={class:"d-flex justify-end flex-wrap gap-4"},Ue={class:"d-flex align-center"},Pe={key:1},De={class:"d-flex flex-column"},xe={class:"text-base"},ke={class:"text-sm text-medium-emphasis"},he={class:"d-flex gap-1 py-2 flex-wrap w-100"},$e={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},Ce={class:"text-sm text-disabled mb-0"},Se=Q({__name:"index",setup(T){const y=W(),p=d(""),f=d("all"),g=J(),C=d(1),m=d(0),U=d([]),D=d([]),s=d({page:1,itemsPerPage:10,sortBy:[],groupBy:[],search:void 0}),x=[{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Roles",key:"role",sortable:!1},{title:"",key:"actions",sortable:!1,width:"70"}],v=ce.debounce(async()=>{var i,o,k;try{const r=await y.fetchUsers({q:p.value,role:f.value,...s.value});U.value=r.data,C.value=((i=r.meta)==null?void 0:i.to)||0,m.value=((o=r.meta)==null?void 0:o.total)||0,s.value.page=((k=r.meta)==null?void 0:k.current_page)||0}catch(r){console.log(r)}},500),B=()=>{v(),g.refreshUser()},P=d(!1),F=i=>{confirm("Are you sure you want to deactivate your account?")&&y.deleteUser(i).then(v)};return G([s,p,f,()=>s.value.itemsPerPage],v),(i,o)=>{const k=ee,r=Z,n=se("RouterLink");return h(),N("section",null,[e(R,null,{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(H,{title:i.$t("Users")},{default:t(()=>[e(K,null,{default:t(()=>[e(R,{align:"end",justify:"space-between"},{default:t(()=>[e(w,{cols:"12",sm:"4"},{default:t(()=>[e(X,{"default-roles":l(D),modelValue:l(f),"onUpdate:modelValue":o[0]||(o[0]=a=>b(f)?f.value=a:null),label:i.$t("Select Role"),multiple:!1,clearable:""},null,8,["default-roles","modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"4"},{default:t(()=>[e(k,{label:i.$t("Items Per Page"),"model-value":l(s).itemsPerPage,items:[10,20,50,100],"onUpdate:modelValue":o[1]||(o[1]=a=>l(s).itemsPerPage=parseInt(a,10))},null,8,["label","model-value"])]),_:1})]),_:1}),e(R,null,{default:t(()=>[e(w,{class:"d-flex gap-5"},{default:t(()=>[e(r,{modelValue:l(p),"onUpdate:modelValue":o[2]||(o[2]=a=>b(p)?p.value=a:null),placeholder:i.$t("Search"),density:"compact"},null,8,["modelValue","placeholder"]),_("div",ye,[e($,{"prepend-icon":"tabler-plus",onClick:o[3]||(o[3]=a=>P.value=!0)},{default:t(()=>[V(c(i.$t("Add New User")),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(E),e(l(ve),{"items-per-page":l(s).itemsPerPage,"onUpdate:itemsPerPage":o[5]||(o[5]=a=>l(s).itemsPerPage=a),page:l(s).page,"onUpdate:page":o[6]||(o[6]=a=>l(s).page=a),items:l(U),"items-length":l(m),headers:x.map(a=>({...a,title:i.$t(a.title)})),class:"text-no-wrap","onUpdate:options":o[7]||(o[7]=a=>s.value=a)},{"item.name":t(({item:a})=>[_("div",Ue,[e(oe,{size:"34",variant:a.raw.avatar?void 0:"tonal",class:"me-3",color:a.raw.avatar?void 0:l(re)(a.raw.role).color},{default:t(()=>[a.raw.avatar?(h(),A(ne,{key:0,src:a.raw.avatar},null,8,["src"])):(h(),N("span",Pe,c(l(fe)(a.raw.name)),1))]),_:2},1032,["variant","color"]),_("div",De,[_("h6",xe,[e(n,{to:l(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}},class:"font-weight-medium user-list-name"},{default:t(()=>[V(c(a.raw.name),1)]),_:2},1032,["to"])]),_("span",ke,c(a.raw.email),1)])])]),"item.role":t(({item:a})=>[_("div",he,[(h(!0),N(ie,null,de(a.raw.role,(u,Y)=>(h(),A(Ve,{label:"",size:"small",color:"default",density:"comfortable",key:Y},{default:t(()=>[V(c(u),1)]),_:2},1024))),128))])]),"item.actions":t(({item:a})=>[e($,{icon:"",variant:"text",size:"small",color:"medium-emphasis"},{default:t(()=>[e(L,{size:"24",icon:"tabler-dots-vertical"}),e(we,{activator:"parent"},{default:t(()=>[e(ge,null,{default:t(()=>[e(z,{to:l(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}}},{prepend:t(()=>[e(L,{icon:"tabler-eye"})]),default:t(()=>[e(q,null,{default:t(()=>[V(c(i.$t("View")),1)]),_:1})]),_:2},1032,["to"]),e(z,{onClick:u=>F(a.raw.id)},{prepend:t(()=>[e(L,{icon:"tabler-trash"})]),default:t(()=>[e(q,null,{default:t(()=>[V(c(i.$t("Delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[e(E),_("div",$e,[_("p",Ce,c(l(ue)(l(s),l(m))),1),e(_e,{"model-value":l(s).page,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value={...l(s),page:a}),length:Math.ceil(l(m)/l(s).itemsPerPage),"total-visible":i.$vuetify.display.xs?1:Math.ceil(l(m)/l(s).itemsPerPage)},{prev:t(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:t(()=>[V(c(i.$t("Previous")),1)]),_:2},1040)]),next:t(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:t(()=>[V(c(i.$t("Next")),1)]),_:2},1040)]),_:1},8,["model-value","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length","headers"])]),_:1},8,["title"]),e(be,{"default-roles":["user"],isDrawerOpen:l(P),"onUpdate:isDrawerOpen":o[8]||(o[8]=a=>b(P)?P.value=a:null),onUserData:B},null,8,["isDrawerOpen"])]),_:1})]),_:1})])}}});typeof j=="function"&&j(Se);export{Se as default};
