import{b as ue,a as ce}from"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-b5be49e2.js";import{_ as pe}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-5b9b39a6.js";import{_ as me}from"./ActionButton-8a4a1c1c.js";import{O as T,Q as $,dD as ve,W as J,X as fe,dE as be,Z as xe,I as w,ab as ye,a1 as z,ac as E,y as a,dr as Ve,bA as K,a0 as W,al as Y,b$ as he,E as ee,cN as ge,ax as L,dZ as ae,d_ as we,am as _e,dq as Ce,R as ke,dF as Pe,U as Se,dI as Te,a2 as $e,a4 as Ee,bU as Ie,d as Fe,t as U,bX as Ue,K as Be,o as C,i as G,B as n,z as De,e as p,ah as Ae,F as j,j as Re,f as B,bh as Ne,aH as Oe,w as D,D as A,m as q,aJ as R,aQ as Me,aq as N,ar as h,n as Q,bv as X,dV as ze,G as Le,af as Z,dP as Ge,ap as H,e3 as je,e4 as qe}from"./main-0fb5c6c1.js";import{r as O}from"./validators-f52bbb1d.js";import{u as Qe}from"./useCourseStore-bcb65a48.js";import{M as Xe}from"./index-7381233a.js";import{V as Ze}from"./VSpacer-a52f38da.js";import{V as He}from"./VMenu-0d165f1d.js";import{V as Je}from"./VList-48ccb2a7.js";import{V as M}from"./VTextField-532f6e97.js";import{V as Ke}from"./VSelect-4aaf1ab0.js";import{V as We}from"./VSwitch-080b758b.js";import{V as Ye}from"./VInput-e0df6d44.js";import{V as ea}from"./VForm-9682cdf4.js";const k=Symbol.for("vuetify:v-expansion-panel"),aa=["default","accordion","inset","popout"],la=T()({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>aa.includes(e)},readonly:Boolean,...$(),...ve(),...J(),...fe()},emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;be(e,k);const{themeClasses:t}=xe(e),r=w(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return ye({VExpansionPanel:{color:z(e,"color")},VExpansionPanelTitle:{readonly:z(e,"readonly")}}),E(()=>a(e.tag,{class:["v-expansion-panels",t.value,r.value,e.class],style:e.style},o)),{}}}),le=ge({color:String,expandIcon:{type:L,default:"$expand"},collapseIcon:{type:L,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"v-expansion-panel-title"),te=T()({name:"VExpansionPanelTitle",directives:{Ripple:Ve},props:{...$(),...le()},setup(e,b){let{slots:o}=b;const t=K(k);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:r,backgroundColorStyles:s}=W(e,"color"),m=w(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return E(()=>{var c;return Y(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value},r.value,e.class],style:[s.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(c=o.default)==null?void 0:c.call(o,m.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[o.actions?o.actions(m.value):a(ee,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[he("ripple"),e.ripple]])}),{}}}),ne=T()({name:"VExpansionPanelText",props:{...$(),...ae()},setup(e,b){let{slots:o}=b;const t=K(k);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:r,onAfterLeave:s}=we(e,t.isSelected);return E(()=>a(Ce,{onAfterLeave:s},{default:()=>{var m;return[Y(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&r.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(m=o.default)==null?void 0:m.call(o)])]),[[_e,t.isSelected.value]])]}})),{}}}),ta=T()({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...$(),...ke(),...Pe(),...ae(),...Se(),...J(),...le()},emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const t=Te(e,k),{backgroundColorClasses:r,backgroundColorStyles:s}=W(e,"bgColor"),{elevationClasses:m}=$e(e),{roundedClasses:c}=Ee(e),P=w(()=>(t==null?void 0:t.disabled.value)||e.disabled),S=w(()=>t.group.items.value.reduce((v,u,_)=>(t.group.selected.value.includes(u.id)&&v.push(_),v),[])),I=w(()=>{const v=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&S.value.some(u=>u-v===1)}),F=w(()=>{const v=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&S.value.some(u=>u-v===-1)});return Ie(k,t),E(()=>{const v=!!(o.text||e.text),u=!!(o.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":I.value,"v-expansion-panel--after-active":F.value,"v-expansion-panel--disabled":P.value},c.value,r.value,e.class],style:[s.value,e.style],"aria-expanded":t.isSelected.value},{default:()=>{var _;return[a("div",{class:["v-expansion-panel__shadow",...m.value]},null),u&&a(te,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[o.title?o.title():e.title]}),v&&a(ne,{key:"text",eager:e.eager},{default:()=>[o.text?o.text():e.text]}),(_=o.default)==null?void 0:_.call(o)]}})}),{}}}),na={class:"text-truncate"},sa={class:"d-flex flex-column align-center"},oa={class:"text-center"},_a=Fe({__name:"CourseChaptersForm",props:{chapters:{default:()=>[]},gridType:{default:"grid"}},setup(e,{expose:b}){const o=e,t=Qe(),r=U(0),s=U(o.chapters),m=U({}),c=Ue({open:!1,type:""}),P=w(()=>{var l;return((l=s.value[r.value])==null?void 0:l.attachments.length)===0?{allowedFileTypes:["video/*"],maxNumberOfFiles:1}:c.type==="upload-chapter-attachment"?{allowedFileTypes:["image/*","application/pdf","video/*"],maxNumberOfFiles:3}:{allowedFileTypes:["*"],maxNumberOfFiles:1}});Be(()=>{s.value.length===0&&s.value.push({title:"",attachments:[],order:0,id:0})});const S=()=>{c.open=!1,c.type=null},I=l=>{c.open=!0,c.type=l},F=l=>{c.type==="upload-chapter-attachment"&&s.value[r.value].attachments.push(...l.map(i=>({...i,visibility:[],download:!1,watermark:""}))),S()},v=async l=>{const i=s.value[l];i.id&&await t.deleteChapter(i.id),s.value=s.value.filter((x,V)=>V!==l)},u=()=>new Promise(async(l,i)=>{for(let x=0;x<s.value.length;x++){r.value=x,await je(100);const{valid:V}=await m.value.validate();if(!V)return qe(),i(new Error("validation faild"))}l("Ok")}),_=async()=>{try{await u(),s.value.push({title:"",attachments:[],order:s.value.length,id:0}),r.value++}catch{}},se=l=>{const i=[...s.value];i[l]=s.value[l-1],i[l-1]=s.value[l],s.value=i},oe=l=>{const i=[...s.value];i[l]=s.value[l+1],i[l+1]=s.value[l],s.value=i};return b({formEl:m,validate:async()=>{try{return await u(),Promise.resolve(s.value)}catch(l){throw l}}}),(l,i)=>{const x=me,V=pe,ie=ue,de=ce;return C(),G(j,null,[a(ea,{ref_key:"formEl",ref:m},{default:n(()=>[a(la,{class:De(p(s).length>1&&"no-icon-rotate"),modelValue:p(r),"onUpdate:modelValue":i[1]||(i[1]=f=>Ae(r)?r.value=f:null),variant:"default"},{default:n(()=>[(C(!0),G(j,null,Re(p(s),(f,g)=>(C(),B(ta,{key:g},{default:n(()=>[a(te,null,Ne({default:n(()=>[a(Oe,{style:{width:"90%"},class:"text-capitalize d-flex pr-0"},{default:n(()=>[D("span",na,A(f.title||`Chapter ${g+1}`),1),a(Ze)]),_:2},1024)]),_:2},[p(s).length>1?{name:"actions",fn:n(()=>[a(He,{transition:"speed-dial-left",location:"left center"},{activator:n(({props:d})=>[a(x,q({variant:"plain",color:"default"},d,{icon:"mdi-dots-vertical"}),null,16)]),default:n(()=>[a(Je,{class:"mr-1 px-2 d-flex gap-1 bg-background"},{default:n(()=>[a(x,{variant:"text",disabled:g===0,onClick:R(d=>se(g),["stop"]),icon:"mdi-arrow-up"},null,8,["disabled","onClick"]),a(x,{variant:"text",disabled:g+1>=e.chapters.length,onClick:R(d=>oe(g),["stop"]),icon:"mdi-arrow-down"},null,8,["disabled","onClick"]),a(x,{variant:"text",onClick:R(d=>v(g),["stop"]),icon:"tabler-trash",color:"error"},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1024),a(ne,{class:"border-t"},{default:n(()=>[a(Me,{class:"mb-5"},{default:n(()=>[a(N,null,{default:n(()=>[a(h,{cols:"12",class:"mb-3"},{default:n(()=>[a(M,{rules:[p(O)],modelValue:f.title,"onUpdate:modelValue":d=>f.title=d,label:l.$t("chapter.fields.title.label")},null,8,["rules","modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(ie,{class:"w-100",items:f.attachments,grid:e.gridType==="grid"?{cols:"12",sm:"6"}:{cols:"12"}},{default:n(({item:d})=>[(C(),B(N,{key:e.gridType,class:"mb-2 py-2 rounded border bg-background w-100 px-1 ma-0"},{default:n(()=>[a(h,Q(X(e.gridType==="list"?{cols:"12",sm:"4"}:{cols:"12"})),{default:n(()=>[a(Xe,{media:d,hasTitle:"",deletable:"","aspect-ratio":"2",onOnDelete:y=>f.attachments=f.attachments.filter(({id:re})=>re!==d.id)},null,8,["media","onOnDelete"])]),_:2},1040),a(h,Q(X(e.gridType==="list"?{cols:"12",sm:"8"}:{cols:"12"})),{default:n(()=>[a(N,null,{default:n(()=>[a(h,{cols:"12"},{default:n(()=>[a(M,{rules:[p(O)],modelValue:d.name,"onUpdate:modelValue":y=>d.name=y,label:l.$t("chapter.fields.title.label")},null,8,["rules","modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(h,{cols:"6"},{default:n(()=>[a(Ke,{modelValue:d.visibility,"onUpdate:modelValue":y=>d.visibility=y,items:["Public","Plan A","Plan B"],label:l.$t("chapter.fields.visibility.label"),rules:[p(O)],chips:"",multiple:""},{"append-inner":n(()=>[a(V,{text:l.$t("chapter.fields.visibility.description")},null,8,["text"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])]),_:2},1024),a(h,{cols:"6",class:"d-flex align-center gap-2"},{default:n(()=>[a(We,{modelValue:d.download,"onUpdate:modelValue":y=>d.download=y,label:l.$t("chapter.fields.download.label")},null,8,["modelValue","onUpdate:modelValue","label"]),a(V,{text:l.$t("chapter.fields.download.description")},null,8,["text"])]),_:2},1024),d.type===p(ze).pdf?(C(),B(h,{key:0,cols:"12"},{default:n(()=>[a(M,{modelValue:d.watermark,"onUpdate:modelValue":y=>d.watermark=y,label:l.$t("chapter.fields.watermark.label")},{"append-inner":n(()=>[a(V,{text:l.$t("chapter.fields.watermark.description")},null,8,["text"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)):Le("",!0)]),_:2},1024)]),_:2},1040)]),_:2},1024))]),_:2},1032,["items","grid"]),a(h,{cols:"12"},{default:n(()=>[a(V,{text:l.$t("media.upload.description")},{default:n(({props:d})=>[a(Z,q({...d,...p(Ge)},{style:{height:"100%"},onClick:i[0]||(i[0]=y=>I("upload-chapter-attachment"))}),{default:n(()=>[D("div",sa,[a(ee,{icon:"fluent:document-add-16-regular",size:"32"}),a(Ye,{class:"mt-2"},{default:n(()=>[H(A(l.$t("media.upload.label")),1)]),_:1})])]),_:2},1040)]),_:1},8,["text"])]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["class","modelValue"])]),_:1},512),D("div",oa,[a(Z,{onClick:_,class:"mt-5",variant:"tonal","append-icon":"tabler-plus",rounded:"pill"},{default:n(()=>[H(A(l.$t("Add Chapter")),1)]),_:1})]),a(de,{"allowed-file-types":p(P).allowedFileTypes,"max-number-of-files":p(P).maxNumberOfFiles,onDone:F,"is-dialog-visible":p(c).open,"onUpdate:isDialogVisible":i[2]||(i[2]=f=>p(c).open=f)},null,8,["allowed-file-types","max-number-of-files","is-dialog-visible"])],64)}}});export{la as V,_a as _,ta as a,te as b,ne as c};
