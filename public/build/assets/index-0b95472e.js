import{_ as K}from"./EditorJs.vue_vue_type_style_index_0_lang-5ed63066.js";import{d as J,r as y,I as W,a8 as q,w as X,o as r,h as p,f as s,b as e,ba as Y,bb as Z,y as w,z as h,q as o,bf as x,bd as ee,k as g,c as _,j as D,F as v,e as i,al as N,b9 as U,c7 as se,eT as le,eU as te,c8 as ae,N as G,a as oe,bc as M,bk as ne,b2 as F}from"./main-2d2efdef.js";import{r as I,u as re}from"./validators-753247d6.js";import{u as H}from"./useRolesStore-3e106e81.js";import{V as ie}from"./VForm-d1b03105.js";import{V as C,a as c}from"./VRow-b362c44e.js";import{V as B}from"./VTextField-a58b9262.js";import{b as de}from"./VInput-84038333.js";import{V as ue}from"./VTable-97ddfd2c.js";import{V as ce}from"./VCheckbox-2b803ef7.js";import{V as me}from"./VTooltip-dfa1b725.js";import{V as O}from"./VSpacer-f886726f.js";import"./VField-92f9d8a9.js";import"./VCheckboxBtn-c66b2d93.js";import"./VSelectionControl-23864fe7.js";const fe=i("tr",null,[i("td",null,[i("h6",{class:"text-h4 mt-8 mb-3"},"Role Permissions")]),i("td",{colspan:"10"})],-1),pe={key:0},_e={class:"d-flex justify-end"},ge=i("td",{colspan:"10"},null,-1),he={class:"d-flex align-center justify-center gap-3 mt-6"},ve=J({__name:"AddEditRoleDialog",props:{rolePermissions:{default:()=>({name:"",type:"",permissions:[]})},isDialogVisible:{type:Boolean},type:{}},emits:["update:isDialogVisible","roleCreated"],setup(T,{emit:$}){const d=T,V=$,R=y([]),b=H();W(async()=>{const a=await b.fetchPermissions();R.value=a.data.reduce((t,f)=>{const k=le(f.name),l=te(f.name),m=t.findIndex(({name:u})=>u===k);return m!==-1?t[m][l]=!1:t.push({name:k,[l]:!1}),t},[])});const n=y({name:"",type:"",permissions:[],payment_link:null,jvzoo_ids:null,code:null,max_projects:{canAddQrcode:!1,canAddImage:!1,qrcode:0,image:0},canAddAgent:!1,max_agents:0,canAddWhitelabel:!1,max_whitelabel:0,max_subusers:0,storage:0,email_subject:null,email_content:{}});q({get:()=>n.value.storage>=0?(n.value.storage/1024/1024).toFixed(0):(-1).toFixed(0),set:a=>{n.value.storage=parseInt(a)>=0?parseInt(a)*1024*1024:parseInt(a)}}),X(()=>d.isDialogVisible,a=>{a&&Object.assign(n.value,{...d.rolePermissions,type:d.type})});const A=async a=>{const t=await a.save();n.value.email_content=t},z=y(),E=async(a,t)=>{try{const{valid:f}=await a;if(!f)return;t==="create"&&await b.addRole(n.value),t==="update"&&await b.updateRole(d.rolePermissions.id||0,n.value),V("roleCreated",n.value),V("update:isDialogVisible",!1)}catch(f){console.error(f)}},L=()=>V("update:isDialogVisible",!1),P=()=>V("update:isDialogVisible",!1);return(a,t)=>{const f=ae,k=K;return r(),p(se,{width:a.$vuetify.display.smAndDown?"auto":900,"model-value":d.isDialogVisible,"onUpdate:modelValue":P},{default:s(()=>[e(f,{onClick:P}),e(U,{class:"pa-sm-8 pa-5"},{default:s(()=>[e(Y,{class:"text-center"},{default:s(()=>[e(Z,{class:"text-h3 mb-3"},{default:s(()=>[w(h(d.rolePermissions.name?"Edit":"Add New")+" "+h(o(n).type),1)]),_:1})]),_:1}),e(x,{class:"mt-6"},{default:s(()=>[e(o(ie),{ref_key:"refPermissionForm",ref:z,onSubmit:t[4]||(t[4]=ee(l=>E(l,a.rolePermissions.name?"update":"create"),["prevent"]))},{default:s(()=>[e(C,null,{default:s(()=>[e(c,{cols:"12",md:"6"},{default:s(()=>[e(B,{rules:[o(I)],modelValue:o(n).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(n).name=l),label:`${o(n).type} Name`},null,8,["rules","modelValue","label"])]),_:1})]),_:1}),o(n).type==="plan"?(r(),p(C,{key:0},{default:s(()=>[e(c,{cols:"12",md:"6"},{default:s(()=>[e(B,{rules:[o(I),o(re)],modelValue:o(n).payment_link,"onUpdate:modelValue":t[1]||(t[1]=l=>o(n).payment_link=l),label:"Payment Link"},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(B,{rules:[o(I)],modelValue:o(n).email_subject,"onUpdate:modelValue":t[2]||(t[2]=l=>o(n).email_subject=l),label:"Email Subject"},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(de,{class:"ml-3"},{default:s(()=>[w("Email Content")]),_:1}),e(k,{class:"border rounded py-2",data:o(n).email_content,onChange:A},null,8,["data"])]),_:1})]),_:1})):g("",!0),o(n).type==="role"?(r(),p(ue,{key:1,class:"permission-table text-no-wrap"},{default:s(()=>[fe,(r(!0),_(v,null,D(o(R),l=>(r(),_("tr",{key:l.name},[i("td",null,h(l.name),1),(r(!0),_(v,null,D(l,(m,u)=>(r(),_(v,{key:u},[u!=="name"?(r(),_("td",pe,[i("div",_e,[e(ce,{modelValue:o(n).permissions,"onUpdate:modelValue":t[3]||(t[3]=S=>o(n).permissions=S),value:`${u}_${l.name}`,label:u.toString()},null,8,["modelValue","value","label"])])])):g("",!0)],64))),128)),ge]))),128))]),_:1})):g("",!0),i("div",he,[e(N,{type:"submit"},{default:s(()=>[w("Submit")]),_:1}),e(N,{color:"secondary",variant:"tonal",onClick:L},{default:s(()=>[w("Cancel")]),_:1})])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}});const be=J({__name:"AvatarLink",props:{user:{},size:{}},setup(T){const $=G();return(d,V)=>{const R=oe("RouterLink");return r(),p(R,{class:"v-avatar",to:o($).user.id===d.user.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:d.user.id}}},{default:s(()=>[e(M,{size:d.size||32},{default:s(()=>[e(ne,{src:d.user.avatar},null,8,["src"]),e(me,{activator:"parent",location:"top"},{default:s(()=>[w(h(d.user.name),1)]),_:1})]),_:1},8,["size"])]),_:1},8,["to"])}}}),Q="/build/assets/girl-using-mobile-26d497df.png",ye=i("h4",{class:"text-h4 mb-6"},"Roles List",-1),Ve=i("p",{class:"mb-0"}," A role provided access to predefined menus so that depending on assigned role an administrator can have access to what he need ",-1),ke={class:"text-h4"},xe={key:0,class:"v-avatar-group"},Ce={class:"d-flex align-center"},we=["onClick"],Re=["src"],Ae=i("span",null,"Add role, if it doesn't exist.",-1),De=i("h4",{class:"text-h4 mb-6"},"Plans List",-1),$e=i("p",{class:"mb-0"}," A (jvzoo) plan provided access to predefined features so that depending on assigned plan an administrator can have access to what he need ",-1),je={class:"text-h4"},Pe={key:0,class:"v-avatar-group"},Se={class:"d-flex align-center"},Ue=["onClick"],ze=["src"],Ee=i("span",null,"Add plan, if it doesn't exist.",-1),Xe=J({__name:"index",setup(T){const $=H(),d=y(),V=q(()=>{var a;return(a=d.value)==null?void 0:a.filter(({type:t})=>t==="role")}),R=q(()=>{var a;return(a=d.value)==null?void 0:a.filter(({type:t})=>t==="plan")}),b=y(!1),j=y(),n=y(!1),A=y("role"),z=(a,t)=>{A.value=t,b.value=!0,j.value=a},E=async()=>{try{const a=await $.fetchRoles({});d.value=a.data}catch(a){console.error(a)}},L=async()=>{try{await E(),G().refreshUser()}catch(a){console.error(a)}};W(E);const P=a=>{n.value=!0,A.value=a};return(a,t)=>{const f=be,k=ve;return r(),p(C,null,{default:s(()=>[e(c,{cols:"12"},{default:s(()=>[ye,Ve]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(C,null,{default:s(()=>[(r(!0),_(v,null,D(o(V),l=>(r(),p(c,{key:l.name,cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(U,{class:"h-100"},{default:s(()=>[e(x,{class:"d-flex align-center pb-1"},{default:s(()=>{var m;return[i("h4",ke,h(l.name),1),e(O),(m=l.users)!=null&&m.length?(r(),_("div",xe,[(r(!0),_(v,null,D(l.users,(u,S)=>(r(),_(v,{key:u},[l.users.length>4&&S<3?(r(),p(f,{key:0,size:36,user:u},null,8,["user"])):g("",!0),l.users.length<=4?(r(),p(f,{key:1,size:36,user:u},null,8,["user"])):g("",!0)],64))),128)),l.users.length>4?(r(),p(M,{key:0,color:a.$vuetify.theme.current.dark?"#4A5072":"#f6f6f7"},{default:s(()=>[i("span",null," +"+h(l.users.length-3),1)]),_:2},1032,["color"])):g("",!0)])):g("",!0)]}),_:2},1024),e(x,{class:"py-10"},{default:s(()=>{var m;return[i("span",null,"Total "+h((m=l.users)==null?void 0:m.length)+" users",1),i("div",Ce,[i("a",{href:"javascript:void(0)",onClick:u=>z(l,"role")}," Edit Role ",8,we)])]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(c,{cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(U,{class:"h-100",ripple:!1,onClick:t[0]||(t[0]=l=>P("role"))},{default:s(()=>[e(C,{"no-gutters":"",class:"h-100"},{default:s(()=>[e(c,{cols:"5",class:"d-flex flex-column justify-end align-center mt-5"},{default:s(()=>[i("img",{width:"85",src:o(Q)},null,8,Re)]),_:1}),e(c,{cols:"7"},{default:s(()=>[e(x,{class:"d-flex flex-column align-end justify-end gap-2 h-100",style:{"text-align":"end"}},{default:s(()=>[e(N,null,{default:s(()=>[w("New Role")]),_:1}),Ae]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12"},{default:s(()=>[De,$e]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(C,null,{default:s(()=>[(r(!0),_(v,null,D(o(R),l=>(r(),p(c,{key:l.name,cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(U,{class:"h-100"},{default:s(()=>[e(x,{class:"d-flex align-center pb-1"},{default:s(()=>{var m;return[i("h4",je,h(l.name),1),e(O),(m=l.users)!=null&&m.length?(r(),_("div",Pe,[(r(!0),_(v,null,D(l.users,(u,S)=>(r(),_(v,{key:u},[l.users.length>4&&S<3?(r(),p(f,{key:0,size:36,user:u},null,8,["user"])):g("",!0),l.users.length<=4?(r(),p(f,{key:1,size:36,user:u},null,8,["user"])):g("",!0)],64))),128)),l.users.length>4?(r(),p(M,{key:0,color:a.$vuetify.theme.current.dark?"#4A5072":"#f6f6f7"},{default:s(()=>[i("span",null," +"+h(l.users.length-3),1)]),_:2},1032,["color"])):g("",!0)])):g("",!0)]}),_:2},1024),e(x,{class:"py-10"},{default:s(()=>{var m;return[i("span",null,"Total "+h((m=l.users)==null?void 0:m.length)+" users",1),i("div",Se,[i("a",{href:"javascript:void(0)",onClick:u=>z(l,"plan")}," Edit Plan ",8,Ue)])]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(c,{cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(U,{class:"h-100",ripple:!1,onClick:t[1]||(t[1]=l=>P("plan"))},{default:s(()=>[e(C,{"no-gutters":"",class:"h-100"},{default:s(()=>[e(c,{cols:"5",class:"d-flex flex-column justify-end align-center mt-5"},{default:s(()=>[i("img",{width:"85",src:o(Q)},null,8,ze)]),_:1}),e(c,{cols:"7"},{default:s(()=>[e(x,{class:"d-flex flex-column align-end justify-end gap-2 h-100",style:{"text-align":"end"}},{default:s(()=>[e(N,null,{default:s(()=>[w("New Plan")]),_:1}),Ee]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{type:o(A),"is-dialog-visible":o(n),"onUpdate:isDialogVisible":t[2]||(t[2]=l=>F(n)?n.value=l:null),onRoleCreated:L},null,8,["type","is-dialog-visible"]),e(k,{"is-dialog-visible":o(b),"onUpdate:isDialogVisible":t[3]||(t[3]=l=>F(b)?b.value=l:null),"role-permissions":o(j),"onUpdate:rolePermissions":t[4]||(t[4]=l=>F(j)?j.value=l:null),type:o(A),onRoleCreated:L},null,8,["is-dialog-visible","role-permissions","type"])]),_:1})}}});export{Xe as default};
