import{_ as $}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-bc3adc91.js";import{_ as A}from"./ActionButton-b764bf63.js";import{_ as B}from"./ResponsiveText.vue_vue_type_script_setup_true_lang-b71e286d.js";import{t as N,r as P,k as D,H as d,v as r,z as c,A as t,x as g,y as E,F as h,n as l,aa as m,a2 as v,D as F,_ as M,E as _,C as k,bZ as H,s as R}from"./plugins-23ac56fa.js";import{b as Z,c as j}from"./utils-6ad673f2.js";import{u as q}from"./useCourseStore-bc687bd9.js";import{a as x,b as I,V as G,c as J}from"./VList-d52d4d68.js";import{V as K}from"./VSkeletonLoader-6d9b67e8.js";import{V as O}from"./VChip-7aebcdb4.js";import{V as Q}from"./VSpacer-82458221.js";const le=N({__name:"CoursePlayList",props:{selected:{},courseId:{}},emits:["update:selected","play"],setup(C,{expose:b,emit:w}){const u=C,V=w,n=P([]),S=s=>{s>=0&&n.value.forEach(o=>{o.type!=="header"&&o.index===s?(o.active=!0,V("update:selected",o)):o.active=!1})},L=()=>{var s,o;if(u.selected){let i=((s=u.selected)==null?void 0:s.index)+1;((o=n.value[i])==null?void 0:o.type)==="header"&&i++,S(i)}},T=()=>{},z=q();return D(async()=>{if(u.courseId)try{const{data:s}=await z.getChapters(u.courseId,{itemsPerPage:1e3});n.value=s.reduce((a,{attachments:i,title:y,id:e})=>(i.length&&(a.push({type:"header",title:y,id:e}),a.push(...i.map((p,f)=>({...p,index:f,active:f===0,chapter_id:e})))),a),[]);const o=n.value.find(a=>a.type==="video"&&a.active);V("update:selected",o)}catch{}}),b({next:L,prev:T}),(s,o)=>{const a=B,i=A,y=$;return d(n).length?(r(),c(G,{key:0,lines:"two"},{default:t(()=>[(r(!0),g(h,null,E(d(n),e=>(r(),g(h,{key:e.id},[e.type!=="header"?(r(),c(x,{key:0,class:"mt-2",title:e.name,to:{name:"course-id-watch-media",params:{id:s.courseId,media:`${e.slug}-${e.id}-${e.chapter_id}`}}},{prepend:t(({isActive:p})=>[F("div",null,[l(M,{style:{"aspect-ratio":"16/9","inline-size":"100px"},class:"rounded mr-2 bg-background border",src:e.thumb_url||d(Z)(e),cover:""},null,8,["src"])])]),title:t(({title:p})=>[l(a,{text:String(p),"max-lines":2,"char-width":2},{default:t(({text:f})=>[m(_(f),1)]),_:2},1032,["text"])]),default:t(()=>[l(J,{class:"d-flex gap-2 pa-1 align-center"},{default:t(()=>[l(k,{size:"16",icon:d(j)(e.type)},null,8,["icon"]),e.type==="video"?(r(),c(O,{key:0,size:"x-small"},{default:t(()=>[l(k,{icon:"mdi-clock-fast",size:"16",class:"mr-1"}),m(" "+_(d(H)(e.duration)),1)]),_:2},1024)):v("",!0),l(Q),e.download?(r(),c(y,{key:1,text:"download"},{default:t(({props:p})=>[l(i,R({size:"x-small",icon:"mdi-download",download:"",href:e.path},p),null,16,["href"])]),_:2},1024)):v("",!0)]),_:2},1024)]),_:2},1032,["title","to"])):(r(),c(x,{key:1},{default:t(()=>[l(I,null,{default:t(()=>[m(_(s.$t("Chapter"))+" - "+_(e.title),1)]),_:2},1024)]),_:2},1024))],64))),128)),d(n).length?v("",!0):(r(),c(x,{key:0},{default:t(()=>[l(I,null,{default:t(()=>[m("Chapter empty")]),_:1})]),_:1}))]),_:1})):(r(),c(d(K),{key:1,type:Array(5).fill("list-item-avatar-three-line")},null,8,["type"]))}}});export{le as _};
