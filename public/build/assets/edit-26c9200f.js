import{_ as I}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-a1d2e702.js";import{_ as P}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-be1303fe.js";import{u as W}from"./useSnackBarStore-e7f838a7.js";import{u as $}from"./useCourseStore-eea862c2.js";import{t as j,a3 as H,a4 as J,r as u,bY as M,v as c,z as v,A as a,n as e,H as r,L as h,x as O,y as Y,F as q,b_ as G,B as C,a2 as w,D as x,aa as K,C as k,E as Q}from"./plugins-900eb03f.js";import{a as y,V as X}from"./VRow-bc79db32.js";import{V as Z,a as tt,b as S,c as et}from"./VWindowItem-0098adf9.js";import{V as ot}from"./VSpacer-35711271.js";import{V as at}from"./VContainer-1a4a926a.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-61f4e6ed.js";import"./VCheckboxBtn-e9892fb1.js";import"./VSelectionControl-9eb14a8c.js";import"./VInput-d19eb2fc.js";import"./index-e8fbdf01.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-5c78031b.js";import"./VTextField-e9152184.js";import"./VField-b7aa3867.js";import"./forwardRefs-6ea3df5c.js";import"./index-cecf332b.js";import"./VToolbar-4167c2d0.js";import"./VCard-6d8b9f87.js";import"./VCardActions-6ec0444f.js";import"./createSimpleFunctional-e9ee8020.js";import"./VAvatar-98f875d9.js";import"./VCardText-65c366cb.js";import"./_commonjsHelpers-de833af9.js";import"./VSkeletonLoader-4cfb77ed.js";import"./VChip-b4e7b548.js";import"./VPagination-771c87c9.js";import"./utils-01d7f181.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-f6b38868.js";import"./preact.module-7f17e2b0.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-65a3d6cf.js";import"./VDialog-bc9d1454.js";import"./VOverlay-d2f68a91.js";import"./scopeId-b697eb6c.js";import"./dialog-transition-eb9759aa.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-a346bd8f.js";import"./VSelect-bce5aa79.js";import"./VList-ff1b2c79.js";import"./ssrBoot-8b4eb22d.js";import"./VDivider-bf01317e.js";import"./VMenu-479530dd.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-0241b29a.js";import"./VTooltip-5075abc5.js";import"./ActionButton-88e06515.js";import"./validators-229769c7.js";import"./useQuizzesStore-90e757e2.js";import"./VExpansionPanel-2b5697f4.js";import"./VForm-4f08ce3e.js";import"./VSwitch-3d7c56ad.js";import"./VTextarea-3a32ae7b.js";import"./VSlideGroup-b88ed46b.js";const rt={class:"d-flex gap-2 justify-space-between mt-8"},ie=j({__name:"edit",setup(st){const g=W(),B=H(),L=J(),V=$(),l=u(0),d=u("list"),f=u([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),i=u(),_=u([]);M(async()=>{var n,o,m;try{i.value=await V.getCourse(Number((n=B.params)==null?void 0:n.id),{additional:{chapters:!0}}),_.value=((o=i.value)==null?void 0:o.chapters)||[],delete i.value.chapters,(m=i.value)==null||delete m.author}catch{L.push({name:"course"})}});const N=async()=>{var o,m;const n=f.value[l.value];try{if(n.title.toLocaleLowerCase()==="details"&&i.value){const s=await((o=n.component)==null?void 0:o.validate());V.updateCourse(i.value.id,s)}if(n.title.toLocaleLowerCase()==="chapters"&&i.value){const s=await((m=n.component)==null?void 0:m.validate()),t=i.value.id,D=s.map((p,F)=>{const b={};return p.attachments.forEach(({name:T,id:E,type:R,download:A,visibility:U,watermark:z})=>{b[E]={name:T,type:R,download:A,visibility:JSON.stringify(U),watermark:z}}),{...p,course_id:t,attachments:b,order:F}});await Promise.all(D.map(p=>V.updateChapter(p.id||0,p))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(s){g.add({text:s==null?void 0:s.message,color:"error",timeout:5e3})}};return(n,o)=>{const m=P,s=I;return c(),v(at,null,{default:a(()=>[e(X,{align:"center"},{default:a(()=>[e(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:a(()=>[e(Z,{modelValue:r(l),"onUpdate:modelValue":o[0]||(o[0]=t=>h(l)?l.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(c(!0),O(q,null,Y(r(f),t=>(c(),v(et,{key:t.icon},{default:a(()=>[e(k,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),x("span",null,Q(t.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(l)===1?(c(),v(y,{key:0},{default:a(()=>[e(G,{modelValue:r(d),"onUpdate:modelValue":o[1]||(o[1]=t=>h(d)?d.value=t:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:a(()=>[e(C,{value:"list",icon:"mdi-list-box-outline"}),e(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),e(y,{cols:"12"},{default:a(()=>[e(tt,{modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=t=>h(l)?l.value=t:null),class:"mt-5 overflow-visible"},{default:a(()=>[e(S,null,{default:a(()=>[e(m,{ref:t=>r(f)[0].component=t,course:r(i)},null,8,["course"])]),_:1}),e(S,null,{default:a(()=>[r(_)?(c(),v(s,{key:0,ref:t=>r(f)[1].component=t,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",rt,[e(ot),e(C,{color:"success",onClick:N},{default:a(()=>[K(" Save "),e(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{ie as default};
