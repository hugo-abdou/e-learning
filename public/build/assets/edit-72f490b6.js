import{_ as I}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-c91b9fe0.js";import{_ as P}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-1bf28d88.js";import{u as W}from"./useSnackBarStore-85ba8e7b.js";import{u as $}from"./useCourseStore-bc687bd9.js";import{t as j,a3 as H,a4 as J,r as u,bY as M,v as c,z as v,A as a,n as e,H as r,L as h,x as O,y as Y,F as q,b_ as G,B as C,a2 as w,D as x,aa as K,C as k,E as Q}from"./plugins-23ac56fa.js";import{a as y,V as X}from"./VRow-85c1bb44.js";import{V as Z,a as tt,b as S,c as et}from"./VWindowItem-42913228.js";import{V as ot}from"./VSpacer-82458221.js";import{V as at}from"./VContainer-48f7eaeb.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-eaa40675.js";import"./VCheckboxBtn-928b9cee.js";import"./VSelectionControl-6b7bc1e2.js";import"./VInput-3fba20f5.js";import"./index-fb540909.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-ef3bc5fd.js";import"./VTextField-8224b973.js";import"./VField-37b3162f.js";import"./forwardRefs-6ea3df5c.js";import"./index-4e2c17ce.js";import"./VToolbar-791af043.js";import"./VCard-76e97c90.js";import"./VCardActions-cfac30f0.js";import"./createSimpleFunctional-510e0cf2.js";import"./VAvatar-6b93ad41.js";import"./VCardText-bc505610.js";import"./_commonjsHelpers-de833af9.js";import"./VSkeletonLoader-6d9b67e8.js";import"./VChip-7aebcdb4.js";import"./VPagination-bf5baa2a.js";import"./utils-6ad673f2.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-f6b38868.js";import"./preact.module-7f17e2b0.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-41bdfac7.js";import"./VDialog-abdd39d4.js";import"./VOverlay-bf54c426.js";import"./scopeId-9684f7d2.js";import"./dialog-transition-4e0bea32.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-871cc6c2.js";import"./VSelect-9be68f15.js";import"./VList-d52d4d68.js";import"./ssrBoot-1ad8a147.js";import"./VDivider-96dac35c.js";import"./VMenu-3cd3f165.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-bc3adc91.js";import"./VTooltip-f4539d91.js";import"./ActionButton-b764bf63.js";import"./validators-510c81af.js";import"./slugify-624934a4.js";import"./useQuizzesStore-b13e1f66.js";import"./VExpansionPanel-0597aa38.js";import"./VForm-40c01a0f.js";import"./VSwitch-8514fd9f.js";import"./VTextarea-c6a67d72.js";import"./VSlideGroup-5bff08b9.js";const rt={class:"d-flex gap-2 justify-space-between mt-8"},le=j({__name:"edit",setup(it){const g=W(),B=H(),L=J(),V=$(),l=u(0),d=u("list"),f=u([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),s=u(),_=u([]);M(async()=>{var m,o,n;try{s.value=await V.getCourse(Number((m=B.params)==null?void 0:m.id),{additional:{chapters:!0}}),_.value=((o=s.value)==null?void 0:o.chapters)||[],delete s.value.chapters,(n=s.value)==null||delete n.author}catch{L.push({name:"course"})}});const N=async()=>{var o,n;const m=f.value[l.value];try{if(m.title.toLocaleLowerCase()==="details"&&s.value){const i=await((o=m.component)==null?void 0:o.validate());V.updateCourse(s.value.id,i)}if(m.title.toLocaleLowerCase()==="chapters"&&s.value){const i=await((n=m.component)==null?void 0:n.validate()),t=s.value.id,D=i.map((p,F)=>{const b={};return p.attachments.forEach(({name:T,id:E,type:R,download:A,visibility:U,watermark:z})=>{b[E]={name:T,type:R,download:A,visibility:JSON.stringify(U),watermark:z}}),{...p,course_id:t,attachments:b,order:F}});await Promise.all(D.map(p=>V.updateChapter(p.id||0,p))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(i){g.add({text:i==null?void 0:i.message,color:"error",timeout:5e3})}};return(m,o)=>{const n=P,i=I;return c(),v(at,null,{default:a(()=>[e(X,{align:"center"},{default:a(()=>[e(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:a(()=>[e(Z,{modelValue:r(l),"onUpdate:modelValue":o[0]||(o[0]=t=>h(l)?l.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(c(!0),O(q,null,Y(r(f),t=>(c(),v(et,{key:t.icon},{default:a(()=>[e(k,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),x("span",null,Q(t.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(l)===1?(c(),v(y,{key:0},{default:a(()=>[e(G,{modelValue:r(d),"onUpdate:modelValue":o[1]||(o[1]=t=>h(d)?d.value=t:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:a(()=>[e(C,{value:"list",icon:"mdi-list-box-outline"}),e(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),e(y,{cols:"12"},{default:a(()=>[e(tt,{modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=t=>h(l)?l.value=t:null),class:"mt-5 overflow-visible"},{default:a(()=>[e(S,null,{default:a(()=>[e(n,{ref:t=>r(f)[0].component=t,course:r(s)},null,8,["course"])]),_:1}),e(S,null,{default:a(()=>[r(_)?(c(),v(i,{key:0,ref:t=>r(f)[1].component=t,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",rt,[e(ot),e(C,{color:"success",onClick:N},{default:a(()=>[K(" Save "),e(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{le as default};
