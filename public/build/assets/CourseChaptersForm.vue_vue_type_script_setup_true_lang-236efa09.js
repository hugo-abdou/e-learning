import{_ as pe,a as me}from"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-832b1526.js";import{_ as ve}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-5f3d2165.js";import{_ as fe}from"./ActionButton-3e3940ad.js";import{a2 as E,a3 as S,bQ as be,aI as Y,aJ as xe,ap as $,bR as Ve,aK as ye,a6 as w,aQ as Z,$ as L,aa as I,b as a,bS as H,R as ee,bT as ge,J as ae,K as he,bU as we,bo as G,aq as _e,ax as le,at as ke,a0 as te,al as Pe,bO as Ce,ak as Te,bP as Ee,as as Se,aw as $e,N as Ie,d as Fe,r as B,bV as Ue,G as Be,o as k,c as j,f as n,p as c,e as D,aj as q,F as J,bb as De,y as Ae,j as Re,v as K,x as A,bW as ze,h as R,bX as Ne,bk as Oe,s as Q,bm as z,bw as Me,bY as W,bZ as X,bD as Le,z as Ge}from"./main-82a96365.js";import{r as N}from"./validators-f52bbb1d.js";import{M as je}from"./index-66089fbe.js";import{u as qe}from"./useCourseStore-77f7fb5f.js";import{s as Je,U as Ke}from"./utils-4a972e46.js";import{V as Qe}from"./VForm-f6a694a4.js";import{V as We}from"./VSpacer-2e04e234.js";import{V as Xe}from"./VMenu-c58a1af8.js";import{V as Ye}from"./VList-807ad1b2.js";import{V as O,a as g}from"./VRow-47aae73e.js";import{V as M}from"./VTextField-fce7c611.js";import{V as Ze}from"./VSelect-58ab7ad1.js";import{V as He}from"./VSwitch-fc915126.js";import{b as ea}from"./VInput-ef64e093.js";const P=Symbol.for("vuetify:v-expansion-panel"),aa=["default","accordion","inset","popout"],la=E({color:String,variant:{type:String,default:"default",validator:e=>aa.includes(e)},readonly:Boolean,...S(),...be(),...Y(),...xe()},"VExpansionPanels"),ta=$()({name:"VExpansionPanels",props:la(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:o}=b;Ve(e,P);const{themeClasses:t}=ye(e),d=w(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Z({VExpansionPanel:{color:L(e,"color")},VExpansionPanelTitle:{readonly:L(e,"readonly")}}),I(()=>a(e.tag,{class:["v-expansion-panels",t.value,d.value,e.class],style:e.style},o)),{}}}),na=E({...S(),...H()},"VExpansionPanelText"),ne=$()({name:"VExpansionPanelText",props:na(),setup(e,b){let{slots:o}=b;const t=ee(P);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:d,onAfterLeave:s}=ge(e,t.isSelected);return I(()=>a(we,{onAfterLeave:s},{default:()=>{var m;return[ae(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[o.default&&d.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(m=o.default)==null?void 0:m.call(o)])]),[[he,t.isSelected.value]])]}})),{}}}),se=E({color:String,expandIcon:{type:G,default:"$expand"},collapseIcon:{type:G,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...S()},"VExpansionPanelTitle"),oe=$()({name:"VExpansionPanelTitle",directives:{Ripple:_e},props:se(),setup(e,b){let{slots:o}=b;const t=ee(P);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:d,backgroundColorStyles:s}=le(e,"color"),m=w(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return I(()=>{var p;return ae(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value},d.value,e.class],style:[s.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(p=o.default)==null?void 0:p.call(o,m.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[o.actions?o.actions(m.value):a(te,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[ke("ripple"),e.ripple]])}),{}}}),sa=E({title:String,text:String,bgColor:String,...S(),...Pe(),...Ce(),...H(),...Te(),...Y(),...se()},"VExpansionPanel"),oa=$()({name:"VExpansionPanel",props:sa(),emits:{"group:selected":e=>!0},setup(e,b){let{slots:o}=b;const t=Ee(e,P),{backgroundColorClasses:d,backgroundColorStyles:s}=le(e,"bgColor"),{elevationClasses:m}=Se(e),{roundedClasses:p}=$e(e),C=w(()=>(t==null?void 0:t.disabled.value)||e.disabled),T=w(()=>t.group.items.value.reduce((v,u,_)=>(t.group.selected.value.includes(u.id)&&v.push(_),v),[])),F=w(()=>{const v=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&T.value.some(u=>u-v===1)}),U=w(()=>{const v=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&T.value.some(u=>u-v===-1)});return Ie(P,t),Z({VExpansionPanelText:{eager:L(e,"eager")}}),I(()=>{const v=!!(o.text||e.text),u=!!(o.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":F.value,"v-expansion-panel--after-active":U.value,"v-expansion-panel--disabled":C.value},p.value,d.value,e.class],style:[s.value,e.style]},{default:()=>{var _;return[a("div",{class:["v-expansion-panel__shadow",...m.value]},null),u&&a(oe,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[o.title?o.title():e.title]}),v&&a(ne,{key:"text"},{default:()=>[o.text?o.text():e.text]}),(_=o.default)==null?void 0:_.call(o)]}})}),{}}}),ia={class:"text-truncate"},ra={class:"d-flex flex-column align-center"},da={class:"text-center"},Ea=Fe({__name:"CourseChaptersForm",props:{chapters:{default:()=>[]},gridType:{default:"grid"}},setup(e,{expose:b}){const o=e,t=qe(),d=B(0),s=B(o.chapters),m=B({}),p=Ue({open:!1,type:""}),C=w(()=>{var l;return((l=s.value[d.value])==null?void 0:l.attachments.length)===0?{allowedFileTypes:["video/*"],maxNumberOfFiles:1}:p.type==="upload-chapter-attachment"?{allowedFileTypes:["image/*","application/pdf","video/*"],maxNumberOfFiles:3}:{allowedFileTypes:["*"],maxNumberOfFiles:1}});Be(()=>{s.value.length===0&&s.value.push({title:"",attachments:[],order:0,id:0})});const T=()=>{p.open=!1,p.type=null},F=l=>{p.open=!0,p.type=l},U=l=>{console.log(l),p.type==="upload-chapter-attachment"&&s.value[d.value].attachments.push(...l.map(i=>({...i,visibility:[],download:!1,watermark:""}))),T()},v=async l=>{const i=s.value[l];i.id&&await t.deleteChapter(i.id),s.value=s.value.filter((x,y)=>y!==l)},u=()=>new Promise(async(l,i)=>{for(let x=0;x<s.value.length;x++){d.value=x,await ze(100);const{valid:y}=await m.value.validate();if(!y)return Je(),i(new Error("validation faild"))}l("Ok")}),_=async()=>{try{await u(),s.value.push({title:"",attachments:[],order:s.value.length,id:0}),d.value++}catch{}},ie=l=>{const i=[...s.value];i[l]=s.value[l-1],i[l-1]=s.value[l],s.value=i},re=l=>{const i=[...s.value];i[l]=s.value[l+1],i[l+1]=s.value[l],s.value=i};return b({formEl:m,validate:async()=>{try{return await u(),Promise.resolve(s.value)}catch(l){throw l}}}),(l,i)=>{const x=fe,y=ve,de=me,ue=pe;return k(),j(J,null,[a(c(Qe),{ref_key:"formEl",ref:m},{default:n(()=>[a(ta,{modelValue:c(d),"onUpdate:modelValue":i[1]||(i[1]=f=>De(d)?d.value=f:null),class:Ae(c(s).length>1&&"no-icon-rotate"),variant:"default"},{default:n(()=>[(k(!0),j(J,null,Re(c(s),(f,h)=>(k(),R(oa,{key:h},{default:n(()=>[a(oe,null,Ne({default:n(()=>[a(Oe,{style:{"inline-size":"90%"},class:"text-capitalize d-flex pr-0"},{default:n(()=>[D("span",ia,A(f.title||`Chapter ${h+1}`),1),a(We)]),_:2},1024)]),_:2},[c(s).length>1?{name:"actions",fn:n(()=>[a(Xe,{transition:"speed-dial-left",location:"left center"},{activator:n(({props:r})=>[a(x,Q({variant:"plain",color:"default"},r,{icon:"mdi-dots-vertical"}),null,16)]),default:n(()=>[a(Ye,{class:"mr-1 px-2 d-flex gap-1 bg-background"},{default:n(()=>[a(x,{variant:"text",disabled:h===0,icon:"mdi-arrow-up",onClick:z(r=>ie(h),["stop"])},null,8,["disabled","onClick"]),a(x,{variant:"text",disabled:h+1>=l.chapters.length,icon:"mdi-arrow-down",onClick:z(r=>re(h),["stop"])},null,8,["disabled","onClick"]),a(x,{variant:"text",icon:"tabler-trash",color:"error",onClick:z(r=>v(h),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1024),a(ne,{class:"border-t"},{default:n(()=>[a(Me,{class:"mb-5"},{default:n(()=>[a(O,null,{default:n(()=>[a(g,{cols:"12",class:"mb-3"},{default:n(()=>[a(M,{modelValue:f.title,"onUpdate:modelValue":r=>f.title=r,rules:[c(N)],label:l.$t("chapter.fields.title.label")},null,8,["modelValue","onUpdate:modelValue","rules","label"])]),_:2},1024),a(de,{class:"w-100",items:f.attachments,grid:l.gridType==="grid"?{cols:"12",sm:"6"}:{cols:"12"}},{default:n(({item:r})=>[(k(),R(O,{key:l.gridType,class:"rounded-lg bg-background border w-100 ma-0"},{default:n(()=>[a(g,W(X(l.gridType==="list"?{cols:"12",md:"4"}:{cols:"12"})),{default:n(()=>[a(je,{media:r,deletable:"","is-preview":"","aspect-ratio":"2",onOnDelete:V=>f.attachments=f.attachments.filter(({id:ce})=>ce!==r.id)},null,8,["media","onOnDelete"])]),_:2},1040),a(g,W(X(l.gridType==="list"?{cols:"12",md:"8"}:{cols:"12"})),{default:n(()=>[a(O,null,{default:n(()=>[a(g,{cols:"12"},{default:n(()=>[a(M,{modelValue:r.name,"onUpdate:modelValue":V=>r.name=V,rules:[c(N)],label:l.$t("chapter.fields.title.label")},null,8,["modelValue","onUpdate:modelValue","rules","label"])]),_:2},1024),a(g,{cols:"12",md:"6"},{default:n(()=>[a(Ze,{modelValue:r.visibility,"onUpdate:modelValue":V=>r.visibility=V,items:["Public","Plan A","Plan B"],label:l.$t("chapter.fields.visibility.label"),rules:[c(N)],chips:"",multiple:""},{"append-inner":n(()=>[a(y,{text:l.$t("chapter.fields.visibility.description")},null,8,["text"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])]),_:2},1024),a(g,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:n(()=>[a(He,{modelValue:r.download,"onUpdate:modelValue":V=>r.download=V,label:l.$t("chapter.fields.download.label")},null,8,["modelValue","onUpdate:modelValue","label"]),a(y,{text:l.$t("chapter.fields.download.description")},null,8,["text"])]),_:2},1024),r.type===c(Le).pdf?(k(),R(g,{key:0,cols:"12"},{default:n(()=>[a(M,{modelValue:r.watermark,"onUpdate:modelValue":V=>r.watermark=V,label:l.$t("chapter.fields.watermark.label")},{"append-inner":n(()=>[a(y,{text:l.$t("chapter.fields.watermark.description")},null,8,["text"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)):Ge("",!0)]),_:2},1024)]),_:2},1040)]),_:2},1024))]),_:2},1032,["items","grid"]),a(g,{cols:"12"},{default:n(()=>[a(y,{text:l.$t("media.upload.description")},{default:n(({props:r})=>[a(q,Q({...r,...c(Ke)},{style:{"block-size":"100%"},onClick:i[0]||(i[0]=V=>F("upload-chapter-attachment"))}),{default:n(()=>[D("div",ra,[a(te,{icon:"fluent:document-add-16-regular",size:"32"}),a(ea,{class:"mt-2"},{default:n(()=>[K(A(l.$t("media.upload.label")),1)]),_:1})])]),_:2},1040)]),_:1},8,["text"])]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue","class"])]),_:1},512),D("div",da,[a(q,{class:"mt-5",variant:"tonal","append-icon":"tabler-plus",rounded:"pill",onClick:_},{default:n(()=>[K(A(l.$t("Add Chapter")),1)]),_:1})]),a(ue,{"is-dialog-visible":c(p).open,"onUpdate:isDialogVisible":i[2]||(i[2]=f=>c(p).open=f),"allowed-file-types":c(C).allowedFileTypes,"max-number-of-files":c(C).maxNumberOfFiles,onDone:U},null,8,["is-dialog-visible","allowed-file-types","max-number-of-files"])],64)}}});export{ta as V,Ea as _,oa as a,oe as b,ne as c};
