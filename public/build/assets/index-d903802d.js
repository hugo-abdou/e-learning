import{_ as K}from"./EditorJs.vue_vue_type_style_index_0_lang-c59d3edb.js";import{_ as X}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-8be18a09.js";import{t as Q,r as V,k as O,aA as M,w as Y,v as r,z as f,A as s,n as e,aa as w,E as v,H as o,bj as Z,a2 as g,x as _,y as D,F as h,D as i,B as F,ev as ee,ew as se,Q as W,S as le,_ as te,L as T}from"./plugins-c4f6eef2.js";import{r as B,u as ae}from"./validators-36c6c447.js";import{u as G}from"./useRolesStore-97ca1410.js";import{a as oe,b as ne,V as E}from"./VCard-5958db4d.js";import{V as x}from"./VCardText-4cd1fd13.js";import{V as re}from"./VForm-d260b3e6.js";import{V as C,a as c}from"./VRow-09d0f266.js";import{V as I}from"./VTextField-bb1687de.js";import{b as ie}from"./VInput-17ef39ba.js";import{V as de}from"./VTable-e4539c1a.js";import{V as ue}from"./VDialog-4773022f.js";import{V as ce}from"./VCheckbox-51f704b8.js";import{V as q}from"./VAvatar-0def7634.js";import{V as me}from"./VTooltip-67331cb4.js";import{V as H}from"./VSpacer-11e98961.js";import"./_commonjsHelpers-de833af9.js";import"./VCardActions-02c72c88.js";import"./createSimpleFunctional-9b6c5de5.js";import"./forwardRefs-6ea3df5c.js";import"./index-ef226c9d.js";import"./VField-02bdfe1c.js";import"./VOverlay-c05a2eb8.js";import"./scopeId-2f824a6c.js";import"./dialog-transition-4789aa6f.js";import"./VCheckboxBtn-3b481ee0.js";import"./VSelectionControl-c4606058.js";const pe=i("tr",null,[i("td",null,[i("h6",{class:"text-h4 mt-8 mb-3"},"Role Permissions")]),i("td",{colspan:"10"})],-1),fe={key:0},_e={class:"d-flex justify-end"},ge=i("td",{colspan:"10"},null,-1),ve={class:"d-flex align-center justify-center gap-3 mt-6"},he=Q({__name:"AddEditRoleDialog",props:{rolePermissions:{default:()=>({name:"",type:"",permissions:[]})},isDialogVisible:{type:Boolean},type:{}},emits:["update:isDialogVisible","roleCreated"],setup(N,{emit:$}){const d=N,b=$,R=V([]),y=G();O(async()=>{const a=await y.fetchPermissions();R.value=a.data.reduce((t,p)=>{const k=ee(p.name),l=se(p.name),m=t.findIndex(({name:u})=>u===k);return m!==-1?t[m][l]=!1:t.push({name:k,[l]:!1}),t},[])});const n=V({name:"",type:"",permissions:[],payment_link:null,jvzoo_ids:null,code:null,max_projects:{canAddQrcode:!1,canAddImage:!1,qrcode:0,image:0},canAddAgent:!1,max_agents:0,canAddWhitelabel:!1,max_whitelabel:0,max_subusers:0,storage:0,email_subject:null,email_content:{}});M({get:()=>n.value.storage>=0?(n.value.storage/1024/1024).toFixed(0):(-1).toFixed(0),set:a=>{n.value.storage=parseInt(a)>=0?parseInt(a)*1024*1024:parseInt(a)}}),Y(()=>d.isDialogVisible,a=>{a&&Object.assign(n.value,{...d.rolePermissions,type:d.type})});const A=async a=>{const t=await a.save();n.value.email_content=t},z=V(),L=async(a,t)=>{try{const{valid:p}=await a;if(!p)return;t==="create"&&await y.addRole(n.value),t==="update"&&await y.updateRole(d.rolePermissions.id||0,n.value),b("roleCreated",n.value),b("update:isDialogVisible",!1)}catch(p){console.error(p)}},U=()=>b("update:isDialogVisible",!1),P=()=>b("update:isDialogVisible",!1);return(a,t)=>{const p=X,k=K;return r(),f(ue,{width:a.$vuetify.display.smAndDown?"auto":900,"model-value":d.isDialogVisible,"onUpdate:modelValue":P},{default:s(()=>[e(p,{onClick:P}),e(E,{class:"pa-sm-8 pa-5"},{default:s(()=>[e(oe,{class:"text-center"},{default:s(()=>[e(ne,{class:"text-h3 mb-3"},{default:s(()=>[w(v(d.rolePermissions.name?"Edit":"Add New")+" "+v(o(n).type),1)]),_:1})]),_:1}),e(x,{class:"mt-6"},{default:s(()=>[e(o(re),{ref_key:"refPermissionForm",ref:z,onSubmit:t[4]||(t[4]=Z(l=>L(l,a.rolePermissions.name?"update":"create"),["prevent"]))},{default:s(()=>[e(C,null,{default:s(()=>[e(c,{cols:"12",md:"6"},{default:s(()=>[e(I,{rules:[o(B)],modelValue:o(n).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(n).name=l),label:`${o(n).type} Name`},null,8,["rules","modelValue","label"])]),_:1})]),_:1}),o(n).type==="plan"?(r(),f(C,{key:0},{default:s(()=>[e(c,{cols:"12",md:"6"},{default:s(()=>[e(I,{rules:[o(B),o(ae)],modelValue:o(n).payment_link,"onUpdate:modelValue":t[1]||(t[1]=l=>o(n).payment_link=l),label:"Payment Link"},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(I,{rules:[o(B)],modelValue:o(n).email_subject,"onUpdate:modelValue":t[2]||(t[2]=l=>o(n).email_subject=l),label:"Email Subject"},null,8,["rules","modelValue"])]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(ie,{class:"ml-3"},{default:s(()=>[w("Email Content")]),_:1}),e(k,{class:"border rounded py-2",data:o(n).email_content,onChange:A},null,8,["data"])]),_:1})]),_:1})):g("",!0),o(n).type==="role"?(r(),f(de,{key:1,class:"permission-table text-no-wrap"},{default:s(()=>[pe,(r(!0),_(h,null,D(o(R),l=>(r(),_("tr",{key:l.name},[i("td",null,v(l.name),1),(r(!0),_(h,null,D(l,(m,u)=>(r(),_(h,{key:u},[u!=="name"?(r(),_("td",fe,[i("div",_e,[e(ce,{modelValue:o(n).permissions,"onUpdate:modelValue":t[3]||(t[3]=S=>o(n).permissions=S),value:`${u}_${l.name}`,label:u.toString()},null,8,["modelValue","value","label"])])])):g("",!0)],64))),128)),ge]))),128))]),_:1})):g("",!0),i("div",ve,[e(F,{type:"submit"},{default:s(()=>[w("Submit")]),_:1}),e(F,{color:"secondary",variant:"tonal",onClick:U},{default:s(()=>[w("Cancel")]),_:1})])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}});const ye=Q({__name:"AvatarLink",props:{user:{},size:{}},setup(N){const $=W();return(d,b)=>{const R=le("RouterLink");return r(),f(R,{class:"v-avatar",to:o($).user.id===d.user.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:d.user.id}}},{default:s(()=>[e(q,{size:d.size||32},{default:s(()=>[e(te,{src:d.user.avatar},null,8,["src"]),e(me,{activator:"parent",location:"top"},{default:s(()=>[w(v(d.user.name),1)]),_:1})]),_:1},8,["size"])]),_:1},8,["to"])}}}),J="/build/assets/girl-using-mobile-26d497df.png",Ve=i("h4",{class:"text-h4 mb-6"},"Roles List",-1),be=i("p",{class:"mb-0"}," A role provided access to predefined menus so that depending on assigned role an administrator can have access to what he need ",-1),ke={class:"text-h4"},xe={key:0,class:"v-avatar-group"},Ce={class:"d-flex align-center"},we=["onClick"],Re=["src"],Ae=i("span",null,"Add role, if it doesn't exist.",-1),De=i("h4",{class:"text-h4 mb-6"},"Plans List",-1),$e=i("p",{class:"mb-0"}," A (jvzoo) plan provided access to predefined features so that depending on assigned plan an administrator can have access to what he need ",-1),je={class:"text-h4"},Pe={key:0,class:"v-avatar-group"},Se={class:"d-flex align-center"},Ee=["onClick"],ze=["src"],Le=i("span",null,"Add plan, if it doesn't exist.",-1),us=Q({__name:"index",setup(N){const $=G(),d=V(),b=M(()=>{var a;return(a=d.value)==null?void 0:a.filter(({type:t})=>t==="role")}),R=M(()=>{var a;return(a=d.value)==null?void 0:a.filter(({type:t})=>t==="plan")}),y=V(!1),j=V(),n=V(!1),A=V("role"),z=(a,t)=>{A.value=t,y.value=!0,j.value=a},L=async()=>{try{const a=await $.fetchRoles({});d.value=a.data}catch(a){console.error(a)}},U=async()=>{try{await L(),W().refreshUser()}catch(a){console.error(a)}};O(L);const P=a=>{n.value=!0,A.value=a};return(a,t)=>{const p=ye,k=he;return r(),f(C,null,{default:s(()=>[e(c,{cols:"12"},{default:s(()=>[Ve,be]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(C,null,{default:s(()=>[(r(!0),_(h,null,D(o(b),l=>(r(),f(c,{key:l.name,cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(E,{class:"h-100"},{default:s(()=>[e(x,{class:"d-flex align-center pb-1"},{default:s(()=>{var m;return[i("h4",ke,v(l.name),1),e(H),(m=l.users)!=null&&m.length?(r(),_("div",xe,[(r(!0),_(h,null,D(l.users,(u,S)=>(r(),_(h,{key:u},[l.users.length>4&&S<3?(r(),f(p,{key:0,size:36,user:u},null,8,["user"])):g("",!0),l.users.length<=4?(r(),f(p,{key:1,size:36,user:u},null,8,["user"])):g("",!0)],64))),128)),l.users.length>4?(r(),f(q,{key:0,color:a.$vuetify.theme.current.dark?"#4A5072":"#f6f6f7"},{default:s(()=>[i("span",null," +"+v(l.users.length-3),1)]),_:2},1032,["color"])):g("",!0)])):g("",!0)]}),_:2},1024),e(x,{class:"py-10"},{default:s(()=>{var m;return[i("span",null,"Total "+v((m=l.users)==null?void 0:m.length)+" users",1),i("div",Ce,[i("a",{href:"javascript:void(0)",onClick:u=>z(l,"role")}," Edit Role ",8,we)])]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(c,{cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(E,{class:"h-100",ripple:!1,onClick:t[0]||(t[0]=l=>P("role"))},{default:s(()=>[e(C,{"no-gutters":"",class:"h-100"},{default:s(()=>[e(c,{cols:"5",class:"d-flex flex-column justify-end align-center mt-5"},{default:s(()=>[i("img",{width:"85",src:o(J)},null,8,Re)]),_:1}),e(c,{cols:"7"},{default:s(()=>[e(x,{class:"d-flex flex-column align-end justify-end gap-2 h-100",style:{"text-align":"end"}},{default:s(()=>[e(F,null,{default:s(()=>[w("New Role")]),_:1}),Ae]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12"},{default:s(()=>[De,$e]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(C,null,{default:s(()=>[(r(!0),_(h,null,D(o(R),l=>(r(),f(c,{key:l.name,cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(E,{class:"h-100"},{default:s(()=>[e(x,{class:"d-flex align-center pb-1"},{default:s(()=>{var m;return[i("h4",je,v(l.name),1),e(H),(m=l.users)!=null&&m.length?(r(),_("div",Pe,[(r(!0),_(h,null,D(l.users,(u,S)=>(r(),_(h,{key:u},[l.users.length>4&&S<3?(r(),f(p,{key:0,size:36,user:u},null,8,["user"])):g("",!0),l.users.length<=4?(r(),f(p,{key:1,size:36,user:u},null,8,["user"])):g("",!0)],64))),128)),l.users.length>4?(r(),f(q,{key:0,color:a.$vuetify.theme.current.dark?"#4A5072":"#f6f6f7"},{default:s(()=>[i("span",null," +"+v(l.users.length-3),1)]),_:2},1032,["color"])):g("",!0)])):g("",!0)]}),_:2},1024),e(x,{class:"py-10"},{default:s(()=>{var m;return[i("span",null,"Total "+v((m=l.users)==null?void 0:m.length)+" users",1),i("div",Se,[i("a",{href:"javascript:void(0)",onClick:u=>z(l,"plan")}," Edit Plan ",8,Ee)])]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(c,{cols:"12",sm:"6",lg:"4"},{default:s(()=>[e(E,{class:"h-100",ripple:!1,onClick:t[1]||(t[1]=l=>P("plan"))},{default:s(()=>[e(C,{"no-gutters":"",class:"h-100"},{default:s(()=>[e(c,{cols:"5",class:"d-flex flex-column justify-end align-center mt-5"},{default:s(()=>[i("img",{width:"85",src:o(J)},null,8,ze)]),_:1}),e(c,{cols:"7"},{default:s(()=>[e(x,{class:"d-flex flex-column align-end justify-end gap-2 h-100",style:{"text-align":"end"}},{default:s(()=>[e(F,null,{default:s(()=>[w("New Plan")]),_:1}),Le]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{type:o(A),"is-dialog-visible":o(n),"onUpdate:isDialogVisible":t[2]||(t[2]=l=>T(n)?n.value=l:null),onRoleCreated:U},null,8,["type","is-dialog-visible"]),e(k,{"is-dialog-visible":o(y),"onUpdate:isDialogVisible":t[3]||(t[3]=l=>T(y)?y.value=l:null),"role-permissions":o(j),"onUpdate:rolePermissions":t[4]||(t[4]=l=>T(j)?j.value=l:null),type:o(A),onRoleCreated:U},null,8,["is-dialog-visible","role-permissions","type"])]),_:1})}}});export{us as default};
