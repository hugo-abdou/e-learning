import{r as q}from"./validators-3b3891f3.js";import{_ as ce}from"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-1ad539a5.js";import{_ as me}from"./DateTimePicker.vue_vue_type_style_index_0_lang-93a11bf5.js";import{_ as pe}from"./CustomRadiosWithIcon-543a6ecd.js";import{_ as fe}from"./EditorJs.vue_vue_type_style_index_0_lang-b276929c.js";import{_ as Ve}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-5436e5d8.js";import{d as _e,r as b,e$ as h,m as ve,a as be,o as c,c as P,b as e,f as t,y as d,bb as R,bc as j,q as i,F as U,j as F,k as I,am as p,v as A,cj as W,e as x,a4 as Q,z as J,b4 as $,bG as H,bh as he,V as ye,h as g,bg as ke}from"./main-de81c04a.js";import{u as we}from"./useQuizzesStore-e152037b.js";import{V as qe}from"./VAppBarTitle-8bd411e9.js";import{V as S,a as u}from"./VRow-712fdf8b.js";import{V as B}from"./VTextField-687a8006.js";import{V as ge}from"./VTextarea-eeb9225e.js";import{b as K}from"./VInput-b77c619e.js";import{V as Ce,a as Z,b as X,c as Y}from"./VExpansionPanel-b89eeb00.js";import{V as ze}from"./VForm-5850c8d7.js";import{V as De}from"./VCheckbox-b63e06bb.js";import{V as ee}from"./VTooltip-3bc1a349.js";import{V as Pe}from"./VSwitch-b42882ed.js";import"./VCheckboxBtn-a8607aa9.js";import"./VSelectionControl-18614d5a.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-d0874295.js";import"./lodash-5f4e712f.js";import"./preact.module-7f17e2b0.js";import"./VWindowItem-74310388.js";import"./VSlideGroup-37f5fce8.js";import"./ssrBoot-7790c7e6.js";import"./component-912afb63.js";import"./VField-cd3a8674.js";import"./VRadioGroup-a114d6de.js";const Ue=1705602791660,Ae=[{id:"fijsBIcGGc",type:"header",data:{text:"Rerum voluptatem ex .",level:1}},{id:"IBLyO6wKtq",type:"math",data:{text:"\begin{CD}  A @>a>> B \\ @VbVV @AAcA \\ C @= D \\end{CD}"}},{id:"0PP_jkyckg",type:"math",data:{text:"\begin{CD} A @>a>> B \\ @VbVV @AAcA \\ C @= D end{CD}"}},{id:"-I8wWNWCxQ",type:"image",data:{file:{url:"https://skillsup.test/storage/media/11/afH9Rzci9sUc67H0CmBk_65a95c1acbcac/original.jpeg"},caption:"",withBorder:!1,stretched:!1,withBackground:!1}}],Qe="2.28.2",$e={time:Ue,blocks:Ae,version:Qe},Se={class:"d-flex flex-column align-center"},Be={class:"d-flex align-start gap-2"},Te={class:"ml-4",style:{width:"40px"}},mt=_e({__name:"create-old",setup(Oe){const T=b([]),w=b(!1),s=b({title:"",description:"",duration:5,status:"Draft",attachments:[],questions:[{id:h(),allow_custom_answer:!1,question:{},options:[{id:h(),option:"",points:0,is_correct:!1}]}]}),L=b({}),O=async()=>{const{valid:a,errors:o}=await L.value.validate();return a?Promise.resolve():Promise.reject(o)},te=()=>{O().then(()=>{s.value.questions.push({id:h(),allow_custom_answer:!1,question:{},options:[{id:h(),option:"",points:0,is_correct:!1}]})})},ae=a=>{O().then(()=>{s.value.questions[a].options.push({id:h(),option:"",points:0,is_correct:!1})})},le=(a,o)=>{s.value.questions[a].options.splice(o,1)},oe=a=>{s.value.questions.splice(a,1)},se=a=>{s.value.questions.push({...s.value.questions[a],id:h(),options:s.value.questions[a].options.map(o=>({...o,id:h()}))})},ie=a=>{s.value.attachments.push(...a),w.value=!1},f=b("publish"),C=b("Private"),ne=[{title:"Private",desc:"Only you see can this quiz",value:"Private",icon:{icon:"carbon:virtual-private-cloud",size:"28"}},{title:"Publish",desc:"All your users can see this quiz",value:"Published",icon:{icon:"mdi-public",size:"28"}}],z=b(new Date().toISOString()),re=a=>{s.value.attachments.splice(a,1)},M=ve(),N=we(),G=()=>new Promise(async(a,o)=>{try{await O();for(let m=0;m<T.value.length;m++){const{editor:V,id:_}=T.value[m],E=await V.save(),l=s.value.questions.findIndex(r=>r.id===_);s.value.questions[l].question=E}const y={};s.value.attachments.forEach(({type:m,id:V,name:_})=>y[V]={type:m,name:_});const D=await N.createQuiz({...s.value,questions:s.value.questions.map(({id:m,question:V,..._})=>({..._,question:JSON.stringify(V)})),attachments:y});f.value==="schedule"&&await N.scheduleQuiz(Number(D.data.id),z.value),f.value==="publish"&&await N.publishQuiz(Number(D.data.id),C.value),a("ok")}catch(y){o(y)}}),ue=()=>{G().then(()=>{M.push({name:"quizzes-create"})})},de=()=>{G().then(()=>{M.push({name:"quizzes"})})};return(a,o)=>{const y=be("Media"),D=Ve,m=fe,V=pe,_=me,E=ce;return c(),P(U,null,[e(qe,null,{default:t(()=>[d("Create a New Quiz")]),_:1}),e(ze,{ref_key:"formEl",ref:L,class:"mt-5"},{default:t(()=>[e(S,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(R,{"prepend-icon":"fluent:quiz-new-24-regular",title:"Quiz Details"},{default:t(()=>[e(j,null,{default:t(()=>[e(S,{class:"pt-2"},{default:t(()=>[e(u,{cols:"12",sm:"8"},{default:t(()=>[e(B,{modelValue:i(s).title,"onUpdate:modelValue":o[0]||(o[0]=l=>i(s).title=l),rules:["requiredValidator"in a?a.requiredValidator:i(q)],label:"Title"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12",sm:"4"},{default:t(()=>[e(B,{modelValue:i(s).duration,"onUpdate:modelValue":o[1]||(o[1]=l=>i(s).duration=l),type:"number",rules:["requiredValidator"in a?a.requiredValidator:i(q)],label:"Duration (minutes)","prepend-inner-icon":"tabler-clock"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(ge,{rows:"2","auto-grow":"",modelValue:i(s).description,"onUpdate:modelValue":o[2]||(o[2]=l=>i(s).description=l),rules:["requiredValidator"in a?a.requiredValidator:i(q)],label:"Description"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(R,{"prepend-icon":"teenyicons:attachment-outline",title:"Quiz Attachments"},{default:t(()=>[e(j,null,{default:t(()=>[e(S,{align:"center"},{default:t(()=>[i(s).attachments.length?(c(!0),P(U,{key:0},F(i(s).attachments,(l,r)=>(c(),g(u,{cols:"12",sm:"6",md:"4",class:"h-100",key:l.id},{default:t(()=>[e(y,{media:l,deletable:"","aspect-ratio":"2/1","is-preview":"",onOnDelete:n=>re(r)},null,8,["media","onOnDelete"])]),_:2},1024))),128)):I("",!0),e(u,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(D,{text:a.$t("media.upload.description")},{default:t(({props:l})=>[e(p,A({...l,...i(W),style:"min-height: 150px;aspect-ratio:2/1"},{onClick:o[3]||(o[3]=r=>w.value=!0)}),{default:t(()=>[x("div",Se,[e(Q,{icon:"flat-color-icons:add-image",size:"28"}),e(K,{class:"mt-2"},{default:t(()=>[d(J(a.$t("media.attachment")),1)]),_:1})])]),_:2},1040)]),_:1},8,["text"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(c(!0),P(U,null,F(i(s).questions,(l,r)=>(c(),g(u,{cols:"12",key:r},{default:t(()=>[e(R,{"prepend-icon":"mdi-account-question-outline",title:`${"Question "+(r+1)} - (${l.options.reduce((n,v)=>n+Number(v.points),0)} Points)`},{append:t(()=>[e(p,A({onClick:n=>se(r)},{variant:"text",density:"compact",color:"default"},{icon:"tabler-copy"}),null,16,["onClick"]),e(p,A({onClick:n=>oe(r)},{variant:"text",density:"compact",color:"error"},{icon:"tabler-trash"}),null,16,["onClick"])]),default:t(()=>[e(j,null,{default:t(()=>[e(S,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(m,{class:"border rounded",placeholder:"Type here your question "+(r+1),ref_for:!0,ref_key:"editorJs",ref:T,data:i($e),holder:l.id},null,8,["placeholder","data","holder"])]),_:2},1024),(c(!0),P(U,null,F(l.options,(n,v)=>(c(),g(u,{key:v,cols:"12"},{default:t(()=>[x("div",Be,[e(B,{id:"option-"+(r+1)+"-"+(v+1),modelValue:n.option,"onUpdate:modelValue":k=>n.option=k,label:"Option "+(v+1),rules:["requiredValidator"in a?a.requiredValidator:i(q)],"base-color":n.is_correct?"success":"default",class:"w-100"},null,8,["id","modelValue","onUpdate:modelValue","label","rules","base-color"]),n.is_correct?(c(),g(B,{key:0,id:"option-points-"+(r+1)+"-"+(v+1),type:"number",modelValue:n.points,"onUpdate:modelValue":k=>n.points=k,label:"Points",rules:["requiredValidator"in a?a.requiredValidator:i(q)],"base-color":n.is_correct?"success":"default"},null,8,["id","modelValue","onUpdate:modelValue","rules","base-color"])):I("",!0),x("div",Te,[e(De,{color:"success",modelValue:n.is_correct,"onUpdate:modelValue":k=>n.is_correct=k},{default:t(()=>[e(ee,{activator:"parent",location:"top"},{default:t(()=>[d(" Correct Answer ")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),l.options.length>1?(c(),g(p,{key:1,onClick:k=>le(r,v),icon:"",density:"compact",color:"error",variant:"text"},{default:t(()=>[e(Q,{icon:"tabler-trash"}),e(ee,{activator:"parent",location:"top"},{default:t(()=>[d(" Delete Option ")]),_:1})]),_:2},1032,["onClick"])):I("",!0)])]),_:2},1024))),128)),e(u,{cols:"12"},{default:t(()=>[e(Pe,{"model-value":l.allow_custom_answer,"onUpdate:modelValue":n=>l.allow_custom_answer=n,label:"Accept custom answers"},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ke,{class:"ma-3"},{default:t(()=>[e(p,{onClick:n=>ae(r),variant:"tonal"},{default:t(()=>[d(" Add Option ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024))),128)),e(u,null,{default:t(()=>[e(p,A(i(W),{onClick:te}),{default:t(()=>[e(K,{class:"mt-2"},{default:t(()=>[d(" Add Question ")]),_:1})]),_:1},16)]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(Ce,{modelValue:i(f),"onUpdate:modelValue":o[6]||(o[6]=l=>$(f)?f.value=l:null),mandatory:"force",variant:"accordion"},{default:t(()=>[e(Z,{value:"publish"},{default:t(()=>[e(X,null,{default:t(()=>[e(Q,{icon:"tabler:send",class:"mr-3"}),d(" Publish Quiz ")]),_:1}),e(H,{class:"mb-2"},{default:t(()=>[d(" Make your Quiz public or private ")]),_:1}),e(Y,{class:"mt-5"},{default:t(()=>[e(V,{"selected-radio":i(C),"onUpdate:selectedRadio":o[4]||(o[4]=l=>$(C)?C.value=l:null),"radio-content":ne,"grid-column":{md:"6"}},null,8,["selected-radio"])]),_:1})]),_:1}),e(Z,{value:"schedule"},{default:t(()=>[e(X,null,{default:t(()=>[e(Q,{icon:"tabler:calendar",class:"mr-3"}),d(" Schedule Quiz ")]),_:1}),e(H,{class:"mb-2"},{default:t(()=>[d(" Select a date to make your Quiz public. ")]),_:1}),e(Y,null,{default:t(()=>[e(_,{modelValue:i(z),"onUpdate:modelValue":o[5]||(o[5]=l=>$(z)?z.value=l:null),style:{width:"min-content"},config:{inline:!0,enableTime:!0,dateFormat:"Z"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{cols:"12"},{default:t(()=>[e(he,{class:"d-flex flex-wrap gap-2"},{default:t(()=>[e(p,{onClick:ue,variant:"outlined",color:"success"},{default:t(()=>[d(J(a.$t(i(f)))+" & Start New Quiz ",1)]),_:1}),e(ye),e(p,{onClick:de,color:"success"},{default:t(()=>[d(J(a.$t(i(f))),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),e(E,{"is-dialog-visible":i(w),"onUpdate:isDialogVisible":o[7]||(o[7]=l=>$(w)?w.value=l:null),"allowed-file-types":["image/*",".pdf","video/*"],onDone:ie},null,8,["is-dialog-visible","allowed-file-types"])],64)}}});export{mt as default};
