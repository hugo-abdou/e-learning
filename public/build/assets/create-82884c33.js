import{r as h}from"./validators-753247d6.js";import{_ as de}from"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-f2d763a2.js";import{_ as ce}from"./DateTimePicker.vue_vue_type_style_index_0_lang-12f1c32b.js";import{_ as me}from"./CustomRadiosWithIcon-610191b9.js";import{_ as pe}from"./EditorJs.vue_vue_type_style_index_0_lang-5ed63066.js";import{_ as fe}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-1bc17a1b.js";import{_ as _e}from"./index-c8be389a.js";import{u as _,U as I}from"./utils-cf604421.js";import{d as Ve,r as v,m as ve,o as c,c as z,b as e,f as t,y as d,b9 as A,ba as E,q as s,F as g,j as N,k as B,al as m,v as C,e as F,a3 as w,z as R,b2 as P,bD as J,bf as be,h as y,be as he}from"./main-2d2efdef.js";import{u as ye}from"./useQuizzesStore-578a44e3.js";import{V as qe}from"./VAppBarTitle-88ff983e.js";import{V as Q,a as n}from"./VRow-b362c44e.js";import{V as U}from"./VTextField-a58b9262.js";import{V as ke}from"./VTextarea-5701c4af.js";import{b as W}from"./VInput-84038333.js";import{V as ze,a as Z,b as G,c as H}from"./VExpansionPanel-8b4637e4.js";import{V as ge}from"./VSpacer-f886726f.js";import{V as Ce}from"./VForm-d1b03105.js";import{V as we}from"./VCheckbox-2b803ef7.js";import{V as K}from"./VTooltip-dfa1b725.js";import"./VCheckboxBtn-c66b2d93.js";import"./VSelectionControl-23864fe7.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-235432c3.js";import"./lodash-af665324.js";import"./preact.module-7f17e2b0.js";import"./VWindowItem-3c677ea6.js";import"./VSlideGroup-5752cb22.js";import"./VList-3e9a4151.js";import"./VDivider-56b2b415.js";import"./component-32c86fd4.js";import"./VField-92f9d8a9.js";import"./VRadioGroup-8505cdaf.js";import"./ActionButton-893daa0c.js";import"./VChip-5110b4ca.js";import"./VPagination-1f9c92d0.js";import"./VMenu-1ed28082.js";const Pe={class:"d-flex flex-column align-center"},Qe={class:"d-flex align-start gap-2"},Ue={class:"ml-4",style:{width:"40px"}},pt=Ve({__name:"create",setup(De){const b=v(!1),i=v({title:"",description:"",duration:5,status:"Draft",attachments:[],questions:[{id:_(),question:"",options:[{id:_(),option:"",points:0,is_correct:!1}]}]}),j=v({}),D=async()=>{const{valid:l,errors:a}=await j.value.validate();return l?Promise.resolve():Promise.reject(a)},X=()=>{D().then(()=>{i.value.questions.push({id:_(),question:"",options:[{id:_(),option:"",points:0,is_correct:!1}]})})},Y=l=>{D().then(()=>{i.value.questions[l].options.push({id:_(),option:"",points:0,is_correct:!1})})},x=(l,a)=>{i.value.questions[l].options.splice(a,1)},ee=l=>{i.value.questions.splice(l,1)},te=l=>{i.value.questions.push({id:_(),question:i.value.questions[l].question,options:i.value.questions[l].options.map(a=>({...a,id:_()}))})},le=l=>{i.value.attachments.push(...l),b.value=!1},p=v("publish"),q=v("Private"),ae=[{title:"Private",desc:"Only you see can this quiz",value:"Private",icon:{icon:"carbon:virtual-private-cloud",size:"28"}},{title:"Publish",desc:"All your users can see this quiz",value:"Published",icon:{icon:"mdi-public",size:"28"}}],k=v(new Date().toISOString()),oe=l=>{i.value.attachments.splice(l,1)},L=ve(),$=ye(),M=async()=>{try{await D();const l={};i.value.attachments.forEach(({type:S,id:T,name:O})=>l[T]={type:S,name:O});const a=await $.createQuiz({...i.value,attachments:l});p.value==="schedule"&&await $.scheduleQuiz(Number(a.data.id),k.value),p.value==="publish"&&await $.publishQuiz(Number(a.data.id),q.value),Promise.resolve()}catch(l){console.log(l),Promise.reject(l)}},se=()=>{M().then(()=>{L.push({name:"quizzes-create"})})},ie=()=>{M().then(()=>{L.push({name:"quizzes"})})};return(l,a)=>{const S=_e,T=fe,O=pe,re=me,ne=ce,ue=de;return c(),z(g,null,[e(qe,null,{default:t(()=>[d("Create a New Quiz")]),_:1}),e(Ce,{ref_key:"formEl",ref:j,class:"mt-5"},{default:t(()=>[e(Q,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(A,{"prepend-icon":"fluent:quiz-new-24-regular",title:"Quiz Details"},{default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"pt-2"},{default:t(()=>[e(n,{cols:"12",sm:"8"},{default:t(()=>[e(U,{modelValue:s(i).title,"onUpdate:modelValue":a[0]||(a[0]=o=>s(i).title=o),rules:["requiredValidator"in l?l.requiredValidator:s(h)],label:"Title"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"12",sm:"4"},{default:t(()=>[e(U,{modelValue:s(i).duration,"onUpdate:modelValue":a[1]||(a[1]=o=>s(i).duration=o),type:"number",rules:["requiredValidator"in l?l.requiredValidator:s(h)],label:"Duration (minutes)","prepend-inner-icon":"tabler-clock"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(ke,{rows:"2","auto-grow":"",modelValue:s(i).description,"onUpdate:modelValue":a[2]||(a[2]=o=>s(i).description=o),rules:["requiredValidator"in l?l.requiredValidator:s(h)],label:"Description"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(A,{"prepend-icon":"teenyicons:attachment-outline",title:"Quiz Attachments"},{default:t(()=>[e(E,null,{default:t(()=>[e(Q,{align:"center"},{default:t(()=>[s(i).attachments.length?(c(!0),z(g,{key:0},N(s(i).attachments,(o,u)=>(c(),y(n,{cols:"12",sm:"6",md:"4",class:"h-100",key:o.id},{default:t(()=>[e(S,{media:o,deletable:"","aspect-ratio":"2/1","is-preview":"",onOnDelete:r=>oe(u)},null,8,["media","onOnDelete"])]),_:2},1024))),128)):B("",!0),e(n,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(T,{text:l.$t("media.upload.description")},{default:t(({props:o})=>[e(m,C({...o,...s(I),style:"min-height: 150px;aspect-ratio:2/1"},{onClick:a[3]||(a[3]=u=>b.value=!0)}),{default:t(()=>[F("div",Pe,[e(w,{icon:"flat-color-icons:add-image",size:"28"}),e(W,{class:"mt-2"},{default:t(()=>[d(R(l.$t("media.attachment")),1)]),_:1})])]),_:2},1040)]),_:1},8,["text"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),(c(!0),z(g,null,N(s(i).questions,(o,u)=>(c(),y(n,{cols:"12",key:u},{default:t(()=>[e(A,{"prepend-icon":"mdi-account-question-outline",title:`${o.question||"Question "+(u+1)} - (${o.options.reduce((r,f)=>r+Number(f.points),0)} Points)`},{append:t(()=>[e(m,C({onClick:r=>te(u)},{variant:"text",density:"compact",color:"default"},{icon:"tabler-copy"}),null,16,["onClick"]),e(m,C({onClick:r=>ee(u)},{variant:"text",density:"compact",color:"error"},{icon:"tabler-trash"}),null,16,["onClick"])]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(O,{class:"border rounded",placeholder:"Type here your question "+(u+1)},null,8,["placeholder"])]),_:2},1024),(c(!0),z(g,null,N(o.options,(r,f)=>(c(),y(n,{key:f,cols:"12"},{default:t(()=>[F("div",Qe,[e(U,{id:"option-"+(u+1)+"-"+(f+1),modelValue:r.option,"onUpdate:modelValue":V=>r.option=V,label:"Option "+(f+1),rules:["requiredValidator"in l?l.requiredValidator:s(h)],"base-color":r.is_correct?"success":"default",class:"w-100"},null,8,["id","modelValue","onUpdate:modelValue","label","rules","base-color"]),r.is_correct?(c(),y(U,{key:0,id:"option-points-"+(u+1)+"-"+(f+1),type:"number",modelValue:r.points,"onUpdate:modelValue":V=>r.points=V,label:"Points",rules:["requiredValidator"in l?l.requiredValidator:s(h)],"base-color":r.is_correct?"success":"default"},null,8,["id","modelValue","onUpdate:modelValue","rules","base-color"])):B("",!0),F("div",Ue,[e(we,{color:"success",modelValue:r.is_correct,"onUpdate:modelValue":V=>r.is_correct=V},{default:t(()=>[e(K,{activator:"parent",location:"top"},{default:t(()=>[d(" Correct Answer ")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),o.options.length>1?(c(),y(m,{key:1,onClick:V=>x(u,f),icon:"",density:"compact",color:"error",variant:"text"},{default:t(()=>[e(w,{icon:"tabler-trash"}),e(K,{activator:"parent",location:"top"},{default:t(()=>[d(" Delete Option ")]),_:1})]),_:2},1032,["onClick"])):B("",!0)])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),e(he,{class:"ma-3"},{default:t(()=>[e(m,{onClick:r=>Y(u),variant:"tonal"},{default:t(()=>[d(" Add Option ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024))),128)),e(n,null,{default:t(()=>[e(m,C(s(I),{onClick:X}),{default:t(()=>[e(W,{class:"mt-2"},{default:t(()=>[d(" Add Question ")]),_:1})]),_:1},16)]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(ze,{modelValue:s(p),"onUpdate:modelValue":a[6]||(a[6]=o=>P(p)?p.value=o:null),mandatory:"force",variant:"accordion"},{default:t(()=>[e(Z,{value:"publish"},{default:t(()=>[e(G,null,{default:t(()=>[e(w,{icon:"tabler:send",class:"mr-3"}),d(" Publish Quiz ")]),_:1}),e(J,{class:"mb-2"},{default:t(()=>[d(" Make your Quiz public or private ")]),_:1}),e(H,{class:"mt-5"},{default:t(()=>[e(re,{"selected-radio":s(q),"onUpdate:selectedRadio":a[4]||(a[4]=o=>P(q)?q.value=o:null),"radio-content":ae,"grid-column":{md:"6"}},null,8,["selected-radio"])]),_:1})]),_:1}),e(Z,{value:"schedule"},{default:t(()=>[e(G,null,{default:t(()=>[e(w,{icon:"tabler:calendar",class:"mr-3"}),d(" Schedule Quiz ")]),_:1}),e(J,{class:"mb-2"},{default:t(()=>[d(" Select a date to make your Quiz public. ")]),_:1}),e(H,null,{default:t(()=>[e(ne,{modelValue:s(k),"onUpdate:modelValue":a[5]||(a[5]=o=>P(k)?k.value=o:null),style:{width:"min-content"},config:{inline:!0,enableTime:!0,dateFormat:"Z"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(be,{class:"d-flex flex-wrap gap-2"},{default:t(()=>[e(m,{onClick:se,variant:"outlined",color:"success"},{default:t(()=>[d(R(l.$t(s(p)))+" & Start New Quiz ",1)]),_:1}),e(ge),e(m,{onClick:ie,color:"success"},{default:t(()=>[d(R(l.$t(s(p))),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),e(ue,{"is-dialog-visible":s(b),"onUpdate:isDialogVisible":a[7]||(a[7]=o=>P(b)?b.value=o:null),"allowed-file-types":["image/*",".pdf","video/*"],onDone:le},null,8,["is-dialog-visible","allowed-file-types"])],64)}}});export{pt as default};
