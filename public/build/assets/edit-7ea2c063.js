import{_ as I}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-601c8574.js";import{_ as P}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-a91de471.js";import{u as W}from"./useSnackBarStore-74a2c581.js";import{u as $}from"./useCourseStore-4716e2d5.js";import{t as j,a3 as H,a4 as J,r as u,bY as M,v as c,z as v,A as a,n as e,H as r,L as h,x as O,y as Y,F as q,b_ as G,B as C,a2 as w,D as x,aa as K,C as k,E as Q}from"./plugins-c4f6eef2.js";import{a as y,V as X}from"./VRow-09d0f266.js";import{V as Z,a as tt,b as S,c as et}from"./VWindowItem-522a2468.js";import{V as ot}from"./VSpacer-11e98961.js";import{V as at}from"./VContainer-8310984c.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-02db8262.js";import"./VCheckboxBtn-3b481ee0.js";import"./VSelectionControl-c4606058.js";import"./VInput-17ef39ba.js";import"./index-ef226c9d.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-6f4c6b11.js";import"./VTextField-bb1687de.js";import"./VField-02bdfe1c.js";import"./forwardRefs-6ea3df5c.js";import"./index-b80f65a5.js";import"./VToolbar-86dabc33.js";import"./VCard-5958db4d.js";import"./VCardActions-02c72c88.js";import"./createSimpleFunctional-9b6c5de5.js";import"./VAvatar-0def7634.js";import"./VCardText-4cd1fd13.js";import"./_commonjsHelpers-de833af9.js";import"./VSkeletonLoader-06e9f617.js";import"./VChip-1d481e33.js";import"./VPagination-97ee5240.js";import"./utils-ce2588c9.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-f6b38868.js";import"./preact.module-7f17e2b0.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-8be18a09.js";import"./VDialog-4773022f.js";import"./VOverlay-c05a2eb8.js";import"./scopeId-2f824a6c.js";import"./dialog-transition-4789aa6f.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-cb69ff3d.js";import"./VSelect-a0ce27e8.js";import"./VList-fccd8390.js";import"./ssrBoot-c2ff78e8.js";import"./VDivider-330fa8e1.js";import"./VMenu-1009da3c.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-f00c108e.js";import"./VTooltip-67331cb4.js";import"./ActionButton-c071f23c.js";import"./validators-36c6c447.js";import"./slugify-624934a4.js";import"./useQuizzesStore-8ed2e461.js";import"./VExpansionPanel-877e453f.js";import"./VForm-d260b3e6.js";import"./VSwitch-39b7b9d4.js";import"./VTextarea-1694114d.js";import"./VSlideGroup-d17552a0.js";const rt={class:"d-flex gap-2 justify-space-between mt-8"},le=j({__name:"edit",setup(it){const g=W(),B=H(),L=J(),V=$(),l=u(0),d=u("list"),f=u([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),s=u(),_=u([]);M(async()=>{var m,o,n;try{s.value=await V.getCourse(Number((m=B.params)==null?void 0:m.id),{additional:{chapters:!0}}),_.value=((o=s.value)==null?void 0:o.chapters)||[],delete s.value.chapters,(n=s.value)==null||delete n.author}catch{L.push({name:"course"})}});const N=async()=>{var o,n;const m=f.value[l.value];try{if(m.title.toLocaleLowerCase()==="details"&&s.value){const i=await((o=m.component)==null?void 0:o.validate());V.updateCourse(s.value.id,i)}if(m.title.toLocaleLowerCase()==="chapters"&&s.value){const i=await((n=m.component)==null?void 0:n.validate()),t=s.value.id,D=i.map((p,F)=>{const b={};return p.attachments.forEach(({name:T,id:E,type:R,download:A,visibility:U,watermark:z})=>{b[E]={name:T,type:R,download:A,visibility:JSON.stringify(U),watermark:z}}),{...p,course_id:t,attachments:b,order:F}});await Promise.all(D.map(p=>V.updateChapter(p.id||0,p))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(i){g.add({text:i==null?void 0:i.message,color:"error",timeout:5e3})}};return(m,o)=>{const n=P,i=I;return c(),v(at,null,{default:a(()=>[e(X,{align:"center"},{default:a(()=>[e(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:a(()=>[e(Z,{modelValue:r(l),"onUpdate:modelValue":o[0]||(o[0]=t=>h(l)?l.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(c(!0),O(q,null,Y(r(f),t=>(c(),v(et,{key:t.icon},{default:a(()=>[e(k,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),x("span",null,Q(t.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(l)===1?(c(),v(y,{key:0},{default:a(()=>[e(G,{modelValue:r(d),"onUpdate:modelValue":o[1]||(o[1]=t=>h(d)?d.value=t:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:a(()=>[e(C,{value:"list",icon:"mdi-list-box-outline"}),e(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),e(y,{cols:"12"},{default:a(()=>[e(tt,{modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=t=>h(l)?l.value=t:null),class:"mt-5 overflow-visible"},{default:a(()=>[e(S,null,{default:a(()=>[e(n,{ref:t=>r(f)[0].component=t,course:r(s)},null,8,["course"])]),_:1}),e(S,null,{default:a(()=>[r(_)?(c(),v(i,{key:0,ref:t=>r(f)[1].component=t,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",rt,[e(ot),e(C,{color:"success",onClick:N},{default:a(()=>[K(" Save "),e(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{le as default};
