import{_ as B}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-7165c29f.js";import{_ as A}from"./ActionButton-4878606a.js";import{_ as N}from"./ResponsiveText.vue_vue_type_script_setup_true_lang-fc540f3f.js";import{d as P,r as $,I as D,q as d,o as r,h as p,f as t,c as g,j as E,F as V,b as l,y as _,k as v,b_ as F,e as M,bm as j,c9 as q,z as m,a4 as I,ca as R,aU as U,c5 as G,V as H,v as J}from"./main-83f81ad7.js";import{u as K}from"./useCourseStore-c17730ae.js";import{a as x,b as C,V as O,c as Q}from"./VList-26f98dda.js";const se=P({__name:"CoursePlayList",props:{selected:{},courseId:{}},emits:["update:selected","play"],setup(b,{expose:w,emit:S}){const u=b,k=S,i=$([]),h=a=>{a>=0&&i.value.forEach(s=>{s.type!=="header"&&s.index===a?(s.active=!0,k("update:selected",s)):s.active=!1})},L=()=>{var a,s;if(u.selected){let n=((a=u.selected)==null?void 0:a.index)+1;((s=i.value[n])==null?void 0:s.type)==="header"&&n++,h(n)}},T=()=>{},z=K();return D(async()=>{if(u.courseId)try{const{data:a}=await z.getChapters(u.courseId,{itemsPerPage:1e3});i.value=a.reduce((o,{attachments:n,title:y,id:e})=>(n.length&&(o.push({type:"header",title:y,id:e}),o.push(...n.map((c,f)=>({...c,index:f,active:f===0,chapter_id:e})))),o),[]);const s=i.value.find(o=>o.type==="video"&&o.active);k("update:selected",s)}catch{}}),w({next:L,prev:T}),(a,s)=>{const o=N,n=A,y=B;return d(i).length?(r(),p(O,{key:0,lines:"two"},{default:t(()=>[(r(!0),g(V,null,E(d(i),e=>(r(),g(V,{key:e.id},[e.type!=="header"?(r(),p(x,{key:0,class:"mt-2",title:e.name,active:e.active,onClick:c=>h(e.index)},{prepend:t(({isActive:c})=>[M("div",null,[l(j,{style:{"aspect-ratio":"16/9","inline-size":"100px"},class:"rounded mr-2 bg-background border",src:e.thumb_url||d(q)(e),cover:""},null,8,["src"])])]),title:t(({title:c})=>[l(o,{text:String(c),"max-lines":2,"char-width":2},{default:t(({text:f})=>[_(m(f),1)]),_:2},1032,["text"])]),default:t(()=>[l(Q,{class:"d-flex gap-2 pa-1 align-center"},{default:t(()=>[l(I,{size:"16",icon:d(R)(e.type)},null,8,["icon"]),e.type==="video"?(r(),p(U,{key:0,size:"x-small"},{default:t(()=>[l(I,{icon:"mdi-clock-fast",size:"16",class:"mr-1"}),_(" "+m(d(G)(e.duration)),1)]),_:2},1024)):v("",!0),l(H),e.download?(r(),p(y,{key:1,text:"download"},{default:t(({props:c})=>[l(n,J({size:"x-small",icon:"mdi-download",download:"",href:e.path},c),null,16,["href"])]),_:2},1024)):v("",!0)]),_:2},1024)]),_:2},1032,["title","active","onClick"])):(r(),p(x,{key:1},{default:t(()=>[l(C,null,{default:t(()=>[_(m(a.$t("Chapter"))+" - "+m(e.title),1)]),_:2},1024)]),_:2},1024))],64))),128)),d(i).length?v("",!0):(r(),p(x,{key:0},{default:t(()=>[l(C,null,{default:t(()=>[_("Chapter empty")]),_:1})]),_:1}))]),_:1})):(r(),p(d(F),{key:1,type:Array(5).fill("list-item-avatar-three-line")},null,8,["type"]))}}});export{se as _};
