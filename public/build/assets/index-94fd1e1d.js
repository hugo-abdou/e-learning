import{_ as K}from"./AppTextField.vue_vue_type_script_setup_true_lang-ea0dc63c.js";import{_ as ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-6b856003.js";import{r as ae,p as te}from"./utils-c92527c4.js";import{d as J,t as d,ax as Q,J as W,o as h,f as A,B as l,y as e,aI as X,aX as Y,e as t,ak as b,aM as le,at as R,au as w,ai as $,as as V,aY as se,a6 as T,aZ as oe,r as re,i as F,w as _,D as c,aL as ne,aW as ie,F as de,j as ue,ah as L,m as M,a_ as j}from"./main-d3200a92.js";import{u as Z}from"./useUserListStore-c0955db6.js";import{r as S,e as me}from"./validators-f52bbb1d.js";import{_ as G}from"./RolesSelectBox.vue_vue_type_script_setup_true_lang-9c46eb3b.js";import{V as pe}from"./VForm-a28d883b.js";import{V as O}from"./VTextField-ff3454b2.js";import{a as fe}from"./formatters-3b7fec12.js";import{l as ce}from"./lodash-470102d3.js";import{V as z}from"./VDivider-4e3adaff.js";import{V as ve}from"./VDataTableServer-26098cc2.js";import{V as Ve}from"./VChip-a6de0ffd.js";import{V as we}from"./VMenu-fe26a8c9.js";import{V as ge,a as E,b as q}from"./VList-66bd46f3.js";import{V as _e}from"./VPagination-3e74e9d0.js";import"./VInput-a4774bed.js";import"./VCheckboxBtn-1b353d8a.js";import"./VTable-a87e5866.js";import"./ssrBoot-4f9d510a.js";const be=J({__name:"AddNewUserDrawer",props:{isDrawerOpen:{type:Boolean,default:!1},brand:null,disabledRoles:{type:Boolean},defaultRoles:null},emits:["update:isDrawerOpen","userData"],setup(I,{emit:y}){const p=I,f=d(!1),g=d(!1),C=d(!1),m=d(),U=d(""),D=d(""),s=d(""),x=d(),v=d({name:void 0,email:void 0,password:void 0}),B=()=>{T(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation(),v.value={name:void 0,email:void 0,password:void 0}})},P=()=>{y("update:isDrawerOpen",!1),k.refreshUser(),T(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation()})},N=Z(),i=()=>{var r;g.value=!0,(r=m.value)==null||r.validate().then(async({valid:n})=>{if(n){try{const a=await N.addUser({name:U.value,email:D.value,role:[],password:s.value,password_confirmation:s.value,terms:!0});y("userData",a.data),y("update:isDrawerOpen",!1),B()}catch(a){a.response.status===422&&(v.value=a.response.data.errors)}g.value=!1}})},o=r=>{y("update:isDrawerOpen",r)},k=Q();return W(()=>p.isDrawerOpen,r=>{p.defaultRoles&&(x.value=p.defaultRoles)}),(r,n)=>{const a=oe;return h(),A(se,{width:r.$vuetify.display.smAndDown?"auto":677,"model-value":p.isDrawerOpen,"onUpdate:modelValue":o},{default:l(()=>[e(a,{onClick:P}),e(X,{title:"Create New User",subtitle:"Created user details will receive a privacy audit."},{default:l(()=>[e(Y,null,{default:l(()=>[e(pe,{ref_key:"refForm",ref:m,modelValue:t(C),"onUpdate:modelValue":n[5]||(n[5]=u=>b(C)?C.value=u:null),onSubmit:le(i,["prevent"])},{default:l(()=>[e(R,null,{default:l(()=>[e(w,{cols:"12",md:"6"},{default:l(()=>[e(O,{modelValue:t(U),"onUpdate:modelValue":n[0]||(n[0]=u=>b(U)?U.value=u:null),rules:[t(S)],label:"Full Name","error-messages":t(v).name},null,8,["modelValue","rules","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(O,{modelValue:t(D),"onUpdate:modelValue":n[1]||(n[1]=u=>b(D)?D.value=u:null),rules:[t(S),t(me)],label:"Email","error-messages":t(v).email},null,8,["modelValue","rules","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(O,{modelValue:t(s),"onUpdate:modelValue":n[2]||(n[2]=u=>b(s)?s.value=u:null),label:"Password",rules:[t(S)],type:t(f)?"text":"password","append-inner-icon":t(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":n[3]||(n[3]=u=>f.value=!t(f)),"error-messages":t(v).password},null,8,["modelValue","rules","type","append-inner-icon","error-messages"])]),_:1}),e(w,{cols:"12",md:"6"},{default:l(()=>[e(G,{rules:[t(S)],modelValue:t(x),"onUpdate:modelValue":n[4]||(n[4]=u=>b(x)?x.value=u:null)},null,8,["rules","modelValue"])]),_:1}),e(w,{cols:"12"},{default:l(()=>[e($,{type:"submit",class:"me-3",loading:t(g),disabled:t(g)},{default:l(()=>[V(" Submit ")]),_:1},8,["loading","disabled"]),e($,{type:"reset",variant:"tonal",color:"secondary",onClick:P},{default:l(()=>[V(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),ye={class:"d-flex justify-end flex-wrap gap-4"},Ue={class:"d-flex align-center"},Pe={key:1},De={class:"d-flex flex-column"},xe={class:"text-base"},ke={class:"text-sm text-medium-emphasis"},he={class:"d-flex gap-1 py-2 flex-wrap w-100"},$e={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},Ce={class:"text-sm text-disabled mb-0"},Se=J({__name:"index",setup(I){const y=Z(),p=d(""),f=d("all"),g=Q(),C=d(1),m=d(0),U=d([]),D=d([]),s=d({page:1,itemsPerPage:10,sortBy:[],groupBy:[],search:void 0}),x=[{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Roles",key:"role",sortable:!1},{title:"",key:"actions",sortable:!1,width:"70"}],v=ce.debounce(async()=>{var i,o,k;try{const r=await y.fetchUsers({q:p.value,role:f.value,...s.value});U.value=r.data,C.value=((i=r.meta)==null?void 0:i.to)||0,m.value=((o=r.meta)==null?void 0:o.total)||0,s.value.page=((k=r.meta)==null?void 0:k.current_page)||0}catch(r){console.log(r)}},500),B=()=>{v(),g.refreshUser()},P=d(!1),N=i=>{confirm("Are you sure you want to deactivate your account?")&&y.deleteUser(i).then(v)};return W([s,p,f,()=>s.value.itemsPerPage],v),(i,o)=>{const k=ee,r=K,n=re("RouterLink");return h(),F("section",null,[e(R,null,{default:l(()=>[e(w,{cols:"12"},{default:l(()=>[e(X,{title:i.$t("Users")},{default:l(()=>[e(Y,null,{default:l(()=>[e(R,{align:"end",justify:"space-between"},{default:l(()=>[e(w,{cols:"12",sm:"4"},{default:l(()=>[e(G,{"default-roles":t(D),modelValue:t(f),"onUpdate:modelValue":o[0]||(o[0]=a=>b(f)?f.value=a:null),label:i.$t("Select Role"),multiple:!1,clearable:""},null,8,["default-roles","modelValue","label"])]),_:1}),e(w,{cols:"12",sm:"4"},{default:l(()=>[e(k,{label:i.$t("Items Per Page"),"model-value":t(s).itemsPerPage,items:[10,20,50,100],"onUpdate:modelValue":o[1]||(o[1]=a=>t(s).itemsPerPage=parseInt(a,10))},null,8,["label","model-value"])]),_:1})]),_:1}),e(R,null,{default:l(()=>[e(w,{class:"d-flex gap-5"},{default:l(()=>[e(r,{modelValue:t(p),"onUpdate:modelValue":o[2]||(o[2]=a=>b(p)?p.value=a:null),placeholder:i.$t("Search"),density:"compact"},null,8,["modelValue","placeholder"]),_("div",ye,[e($,{"prepend-icon":"tabler-plus",onClick:o[3]||(o[3]=a=>P.value=!0)},{default:l(()=>[V(c(i.$t("Add New User")),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(z),e(t(ve),{"items-per-page":t(s).itemsPerPage,"onUpdate:itemsPerPage":o[5]||(o[5]=a=>t(s).itemsPerPage=a),page:t(s).page,"onUpdate:page":o[6]||(o[6]=a=>t(s).page=a),items:t(U),"items-length":t(m),headers:x.map(a=>({...a,title:i.$t(a.title)})),class:"text-no-wrap","onUpdate:options":o[7]||(o[7]=a=>s.value=a)},{"item.name":l(({item:a})=>[_("div",Ue,[e(ne,{size:"34",variant:a.raw.avatar?void 0:"tonal",class:"me-3",color:a.raw.avatar?void 0:t(ae)(a.raw.role).color},{default:l(()=>[a.raw.avatar?(h(),A(ie,{key:0,src:a.raw.avatar},null,8,["src"])):(h(),F("span",Pe,c(t(fe)(a.raw.name)),1))]),_:2},1032,["variant","color"]),_("div",De,[_("h6",xe,[e(n,{to:t(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}},class:"font-weight-medium user-list-name"},{default:l(()=>[V(c(a.raw.name),1)]),_:2},1032,["to"])]),_("span",ke,c(a.raw.email),1)])])]),"item.role":l(({item:a})=>[_("div",he,[(h(!0),F(de,null,ue(a.raw.role,(u,H)=>(h(),A(Ve,{label:"",size:"small",color:"default",density:"comfortable",key:H},{default:l(()=>[V(c(u),1)]),_:2},1024))),128))])]),"item.actions":l(({item:a})=>[e($,{icon:"",variant:"text",size:"small",color:"medium-emphasis"},{default:l(()=>[e(L,{size:"24",icon:"tabler-dots-vertical"}),e(we,{activator:"parent"},{default:l(()=>[e(ge,null,{default:l(()=>[e(E,{to:t(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}}},{prepend:l(()=>[e(L,{icon:"tabler-eye"})]),default:l(()=>[e(q,null,{default:l(()=>[V(c(i.$t("View")),1)]),_:1})]),_:2},1032,["to"]),e(E,{onClick:u=>N(a.raw.id)},{prepend:l(()=>[e(L,{icon:"tabler-trash"})]),default:l(()=>[e(q,null,{default:l(()=>[V(c(i.$t("Delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:l(()=>[e(z),_("div",$e,[_("p",Ce,c(t(te)(t(s),t(m))),1),e(_e,{"model-value":t(s).page,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value={...t(s),page:a}),length:Math.ceil(t(m)/t(s).itemsPerPage),"total-visible":i.$vuetify.display.xs?1:Math.ceil(t(m)/t(s).itemsPerPage)},{prev:l(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:l(()=>[V(c(i.$t("Previous")),1)]),_:2},1040)]),next:l(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:l(()=>[V(c(i.$t("Next")),1)]),_:2},1040)]),_:1},8,["model-value","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length","headers"])]),_:1},8,["title"]),e(be,{"default-roles":["user"],isDrawerOpen:t(P),"onUpdate:isDrawerOpen":o[8]||(o[8]=a=>b(P)?P.value=a:null),onUserData:B},null,8,["isDrawerOpen"])]),_:1})]),_:1})])}}});typeof j=="function"&&j(Se);export{Se as default};
