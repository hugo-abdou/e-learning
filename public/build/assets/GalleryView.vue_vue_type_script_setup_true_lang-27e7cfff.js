import{d as x,t as m,I as T,bT as D,c0 as F,o as l,i as k,ao as N,f as p,B as u,F as L,j as H,au as Q,m as W,x as z,as as G,D as $,at as X,w as I,ah as P,E as w,az as J,ai as Y,G as A,dK as K,dL as V,y as n,aS as j,e as a,dM as E,aL as Z,aM as ee,dN as ae,z as S,aI as te,n as se,bw as oe,J as O,am as le,k as ne,ak as re}from"./main-6856e496.js";import{c as ce}from"./utils-3e673e05.js";import{V as R}from"./VChip-bb22c723.js";import{V as ie}from"./VSpacer-6c1ac7c1.js";import{_ as de}from"./AppTextField.vue_vue_type_script_setup_true_lang-24a58000.js";import{V as ue}from"./VCheckbox-de9fcfb8.js";import{a as me}from"./VInput-05f64f58.js";import{l as U}from"./lodash-9761b882.js";const pe={class:"pa-5"},fe=x({__name:"Masonry",props:{items:Array,isLoading:Boolean,grid:Object},emits:["load"],setup(t,{emit:f}){const r=m(),v=m(),e=m(),h=async c=>{c[0].isIntersecting&&f("load")};return T(async()=>{r.value=new IntersectionObserver(h,{rootMargin:"10px"}),f("load"),r.value.observe(v.value)}),D(()=>r.value&&r.value.disconnect()),(c,_)=>{const i=F("masonry-tile"),M=F("masonry");return l(),k("div",{ref_key:"container",ref:e},[N((l(),p(X,{class:"me-0 mx-auto","transition-duration":"0.3s","item-selector":".item"},{default:u(()=>[(l(!0),k(L,null,H(t.items,(y,b)=>N((l(),p(Q,W({key:y.id+"_"+b,class:"item"},t.grid||{cols:12,md:4,sm:6,xl:3}),{default:u(()=>[z(c.$slots,"default",{item:y,index:b,redrawVueMasonry:c.$redrawVueMasonry},()=>[G($(y),1)])]),_:2},1040)),[[i]])),128))]),_:3})),[[M]]),I("div",{ref_key:"sentinel",ref:v,class:"d-flex justify-center py-5"},[I("span",pe,[t.isLoading?(l(),p(P,{key:0,icon:"svg-spinners:tadpole"})):w("",!0)])],512)],512)}}}),ve={};function ye(t,f){return l(),p(Y,{variant:"tonal",class:"text-lg",size:"x-small"})}const _e=J(ve,[["render",ye]]),be={class:"w-100 h-100 rounded bg-surface border media-card overflow-hidden"},he=["title"],ge=x({inheritAttrs:!1}),we=x({...ge,__name:"Media",props:{hasTitle:{type:Boolean,default:!1},isPreview:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},media:null},emits:["onDelete"],setup(t,{emit:f}){const r=t,v=m(r.isPreview),e=m(r.media),h=A(()=>ce(e.value.status)),c={video:"/video_placeholder.gif",image:"/image-placeholder.jpg"},_=A(()=>e.value.thumb_url||c[e.value.type]);m();const i=K(),M=()=>{i.openPlayer({thumb:_,url:e.value.url})};let y;const b=async()=>{try{const s=await i.getById(e.value.id);e.value=s,s.status===V.Completed&&clearInterval(y)}catch{}},o=async()=>{try{const s=await i.retry(e.value.id);e.value=s}catch{}},d=s=>{f("onDelete",s.id)};return T(()=>{(e.value.status===V.Pending||e.value.status===V.Processing)&&(y=setInterval(b,5e3))}),D(()=>{clearInterval(y)}),(s,B)=>{const C=_e;return l(),k("div",be,[n(te,{color:"surface",style:{"aspect-ratio":"16/9"},class:S([t.hasTitle?"rounded-b-0":"rounded","h-100 w-100"])},{default:u(()=>[n(j,{src:a(_),class:"w-100 h-100",cover:""},null,8,["src"]),n(j,{src:a(_),style:{top:"0"},class:"w-100 h-100 position-absolute blurred-background rounded"},null,8,["src"]),n(E,{color:"#c9c9c900",density:"compact",absolute:"",style:{top:"0"}},{default:u(()=>[n(Z,{size:"26",class:"ml-1",color:"#fff",variant:"text"},{default:u(()=>[n(P,{size:"18",icon:a(e).type==="video"?"tabler:video":"mdi-image-outline"},null,8,["icon"])]),_:1}),a(e).status!==a(V).Completed?(l(),p(R,{key:0,size:"small",class:"ma-1",color:a(h).color},{default:u(()=>[n(P,{start:"",size:"16",icon:a(h).icon},null,8,["icon"]),G(" "+$(a(h).lable),1)]),_:1},8,["color"])):w("",!0),a(e).status===a(V).Error?(l(),p(C,{key:1,onClick:o,icon:"tabler:refresh",color:"error",class:"ml-1"})):w("",!0),z(s.$slots,"toolbar",{},void 0,!0),n(ie),t.deletable?(l(),p(C,{key:2,onClick:B[0]||(B[0]=ee(g=>d(a(e)),["stop"])),icon:"tabler-trash",color:"error",class:"mr-1 text-error"})):w("",!0)]),_:3}),a(v)?w("",!0):(l(),p(E,{key:0,color:"#7e7e7e00",density:"compact",absolute:"",style:{bottom:"0"}},{default:u(()=>[a(e).type==="video"&&a(e).status===a(V).Completed?(l(),k(L,{key:0},[n(R,{size:"small",class:"ml-1",color:"#fff",variant:"tonal"},{default:u(()=>[n(P,{start:"",size:"16",icon:"mdi-clock-fast"}),I("span",null,$(a(ae)(a(e).duration)),1)]),_:1}),n(C,{onClick:M,icon:"mdi-play-circle",color:"#fff",variant:"text"})],64)):w("",!0)]),_:1}))]),_:3},8,["class"]),t.hasTitle?(l(),k("p",{key:0,class:"truncate px-2 py-2 ma-0",title:a(e).name},$(a(e).name),9,he)):w("",!0),z(s.$slots,"default",{},void 0,!0)])}}});const Ve=J(we,[["__scopeId","data-v-bcc8a99f"]]),ke=x({inheritAttrs:!1}),xe=x({...ke,__name:"CustomCheckboxe",props:{selected:{type:Boolean}},setup(t,{emit:f}){return(r,v)=>(l(),p(me,{class:S(["custom-input custom-checkbox rounded-lg cursor-pointer w-100 overflow-hidden pa-0",t.selected?"active":""])},{default:u(()=>[n(ue,se(oe(r.$attrs)),null,16),z(r.$slots,"default",{class:S(t.selected?"custom-checkbox-image bg-primary":"custom-checkbox-image")})]),_:3},8,["class"]))}});const Te=x({__name:"GalleryView",props:{selectable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1},options:null,grid:null,modelValue:{default:()=>[]},searchPosisions:null,maxNumberSelectableFiles:{default:5},allowedFileTypes:null},emits:["onDelete","onChange","update:model-value"],setup(t,{emit:f}){const r=t,v=K(),e=m([]),h=m(!1),c=m(r.modelValue.map(({id:o})=>o));O(c,o=>{f("update:model-value",e.value.filter(({id:d})=>o.includes(d)))});const _=m(0),i=m({page:1,itemsPerPage:10,sortBy:[],groupBy:[],search:void 0,...r.options}),M=U.debounce(async()=>{e.value.length<_.value&&(i.value.page++,e.value.push(...await b()))},500);O(()=>i.value.search,U.debounce(async()=>{i.value.page=1,e.value=await b()},500));const y=async o=>{await v.delete(o),e.value=e.value.filter(({id:d})=>d!==o),f("onDelete",o)},b=async()=>{var o,d;try{const s=await v.get({...i.value,types:r.allowedFileTypes});return i.value.page=((o=s.meta)==null?void 0:o.current_page)||1,_.value=((d=s.meta)==null?void 0:d.total)||0,Promise.resolve(s.data)}catch(s){throw s}};return T(async()=>{i.value.page=1;const o=await b();e.value=o}),D(()=>{v.$reset()}),(o,d)=>{const s=de,B=Ve,C=fe;return l(),k(L,null,[I("div",{class:"mb-5 position-sticky bg-surface rounded pa-4 px-3",style:le({top:t.searchPosisions||"0px","z-index":10})},[n(s,{modelValue:a(i).search,"onUpdate:modelValue":d[0]||(d[0]=g=>a(i).search=g),placeholder:o.$t("Search"),density:"compact"},null,8,["modelValue","placeholder"])],4),n(C,{grid:t.grid,"is-loading":a(h),onLoad:a(M),items:a(e)},{default:u(({item:g})=>[(l(),p(ne(t.selectable?xe:"div"),{modelValue:a(c),"onUpdate:modelValue":d[1]||(d[1]=q=>re(c)?c.value=q:null),disabled:a(c).length>=t.maxNumberSelectableFiles&&!a(c).includes(g.id),selected:a(c).includes(g.id),value:g.id},{default:u(()=>[n(B,{deletable:t.deletable,media:g,onOnDelete:y,"has-title":""},null,8,["deletable","media"])]),_:2},1032,["modelValue","disabled","selected","value"]))]),_:1},8,["grid","is-loading","onLoad","items"])],64)}}});export{Te as _,Ve as a,_e as b};
