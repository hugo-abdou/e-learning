import{_ as I}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-e900f918.js";import{_ as P}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-f3ea679f.js";import{u as W}from"./useSnackBarStore-183546a7.js";import{u as $}from"./useCourseStore-128d3b36.js";import{t as j,a3 as H,a4 as J,r as u,bY as M,v as c,z as v,A as a,n as e,H as r,L as h,x as O,y as Y,F as q,b_ as G,B as C,a2 as w,D as x,aa as K,C as k,E as Q}from"./plugins-20f6c63a.js";import{a as y,V as X}from"./VRow-9970c9d9.js";import{V as Z,a as tt,b as S,c as et}from"./VWindowItem-e6809476.js";import{V as ot}from"./VSpacer-65846308.js";import{V as at}from"./VContainer-156d0b9d.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-cb04a084.js";import"./VCheckboxBtn-2871d378.js";import"./VSelectionControl-32c86160.js";import"./VInput-df115ab9.js";import"./index-755f2f9e.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-5a82d17e.js";import"./VTextField-24d0bc09.js";import"./VField-78f5f7c6.js";import"./forwardRefs-6ea3df5c.js";import"./index-0a5c7226.js";import"./VToolbar-c437b776.js";import"./VCard-30e4f82a.js";import"./VCardActions-aebc9678.js";import"./createSimpleFunctional-991d7489.js";import"./VAvatar-d93e5e0c.js";import"./VCardText-d52ac2bc.js";import"./_commonjsHelpers-de833af9.js";import"./VSkeletonLoader-eb9e7f48.js";import"./VChip-99c6b32d.js";import"./VPagination-32d7de4c.js";import"./utils-75e2a70f.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-f6b38868.js";import"./preact.module-7f17e2b0.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-58e41beb.js";import"./VDialog-b5e757d9.js";import"./VOverlay-d4a32956.js";import"./scopeId-3cd861c8.js";import"./dialog-transition-beb6505c.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-9bd5cab5.js";import"./VSelect-9fed1c22.js";import"./VList-a614effd.js";import"./ssrBoot-2d263cb5.js";import"./VDivider-371081d3.js";import"./VMenu-baca4a70.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-947f9f5f.js";import"./VTooltip-56957888.js";import"./ActionButton-24ffe583.js";import"./validators-6e538dce.js";import"./slugify-624934a4.js";import"./useQuizzesStore-3b136e41.js";import"./VExpansionPanel-1a39f22b.js";import"./VForm-d5279851.js";import"./VSwitch-94970a91.js";import"./VTextarea-de0927b7.js";import"./VSlideGroup-ee562ac5.js";const rt={class:"d-flex gap-2 justify-space-between mt-8"},le=j({__name:"edit",setup(it){const g=W(),B=H(),L=J(),V=$(),l=u(0),d=u("list"),f=u([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),s=u(),_=u([]);M(async()=>{var m,o,n;try{s.value=await V.getCourse(Number((m=B.params)==null?void 0:m.id),{additional:{chapters:!0}}),_.value=((o=s.value)==null?void 0:o.chapters)||[],delete s.value.chapters,(n=s.value)==null||delete n.author}catch{L.push({name:"course"})}});const N=async()=>{var o,n;const m=f.value[l.value];try{if(m.title.toLocaleLowerCase()==="details"&&s.value){const i=await((o=m.component)==null?void 0:o.validate());V.updateCourse(s.value.id,i)}if(m.title.toLocaleLowerCase()==="chapters"&&s.value){const i=await((n=m.component)==null?void 0:n.validate()),t=s.value.id,D=i.map((p,F)=>{const b={};return p.attachments.forEach(({name:T,id:E,type:R,download:A,visibility:U,watermark:z})=>{b[E]={name:T,type:R,download:A,visibility:JSON.stringify(U),watermark:z}}),{...p,course_id:t,attachments:b,order:F}});await Promise.all(D.map(p=>V.updateChapter(p.id||0,p))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(i){g.add({text:i==null?void 0:i.message,color:"error",timeout:5e3})}};return(m,o)=>{const n=P,i=I;return c(),v(at,null,{default:a(()=>[e(X,{align:"center"},{default:a(()=>[e(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:a(()=>[e(Z,{modelValue:r(l),"onUpdate:modelValue":o[0]||(o[0]=t=>h(l)?l.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(c(!0),O(q,null,Y(r(f),t=>(c(),v(et,{key:t.icon},{default:a(()=>[e(k,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),x("span",null,Q(t.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(l)===1?(c(),v(y,{key:0},{default:a(()=>[e(G,{modelValue:r(d),"onUpdate:modelValue":o[1]||(o[1]=t=>h(d)?d.value=t:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:a(()=>[e(C,{value:"list",icon:"mdi-list-box-outline"}),e(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),e(y,{cols:"12"},{default:a(()=>[e(tt,{modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=t=>h(l)?l.value=t:null),class:"mt-5 overflow-visible"},{default:a(()=>[e(S,null,{default:a(()=>[e(n,{ref:t=>r(f)[0].component=t,course:r(s)},null,8,["course"])]),_:1}),e(S,null,{default:a(()=>[r(_)?(c(),v(i,{key:0,ref:t=>r(f)[1].component=t,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",rt,[e(ot),e(C,{color:"success",onClick:N},{default:a(()=>[K(" Save "),e(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{le as default};
