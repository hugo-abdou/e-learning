import{_ as I}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-54a932f3.js";import{_ as P}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-da4ea3e0.js";import{u as W}from"./useSnackBarStore-955d5a92.js";import{u as $}from"./useCourseStore-b2aa19e2.js";import{t as j,a3 as H,a4 as J,r as u,bY as M,v as c,z as v,A as a,n as e,H as r,L as h,x as O,y as Y,F as q,b_ as G,B as C,a2 as w,D as x,aa as K,C as k,E as Q}from"./plugins-1ca62e54.js";import{a as y,V as X}from"./VRow-063e83bb.js";import{V as Z,a as tt,b as S,c as et}from"./VWindowItem-24433b63.js";import{V as ot}from"./VSpacer-b2217678.js";import{V as at}from"./VContainer-55501e15.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-76076707.js";import"./VCheckboxBtn-bf01db5f.js";import"./VSelectionControl-1b1614f2.js";import"./VInput-0f0d564d.js";import"./index-290985fb.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-9838b75e.js";import"./VTextField-38237e59.js";import"./VField-5f020633.js";import"./forwardRefs-6ea3df5c.js";import"./index-b32b8b4e.js";import"./VToolbar-96f2844b.js";import"./VCard-2a55749d.js";import"./VCardActions-114e80cb.js";import"./createSimpleFunctional-4f87dcb7.js";import"./VAvatar-15acdbba.js";import"./VCardText-f87185bc.js";import"./_commonjsHelpers-de833af9.js";import"./VSkeletonLoader-2a84e475.js";import"./VChip-412e0c07.js";import"./VPagination-03e938d2.js";import"./utils-4f96d8b5.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-f6b38868.js";import"./preact.module-7f17e2b0.js";import"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-3d4c07f0.js";import"./VDialog-5c924145.js";import"./VOverlay-ce640807.js";import"./scopeId-598a8366.js";import"./dialog-transition-7fd252b6.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-ed142275.js";import"./VSelect-4231bef2.js";import"./VList-32d892a6.js";import"./ssrBoot-6bb28df7.js";import"./VDivider-e9bd568d.js";import"./VMenu-3b09bac4.js";import"./InfoTooltip.vue_vue_type_script_setup_true_lang-d423ce93.js";import"./VTooltip-98a36fe7.js";import"./ActionButton-0cde9d24.js";import"./validators-3a378363.js";import"./slugify-624934a4.js";import"./useQuizzesStore-6ffdf938.js";import"./VExpansionPanel-60a279c2.js";import"./VForm-11822a25.js";import"./VSwitch-15c3cd26.js";import"./VTextarea-8a139c5f.js";import"./VSlideGroup-cb6b3143.js";const rt={class:"d-flex gap-2 justify-space-between mt-8"},le=j({__name:"edit",setup(it){const g=W(),B=H(),L=J(),V=$(),l=u(0),d=u("list"),f=u([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),s=u(),_=u([]);M(async()=>{var m,o,n;try{s.value=await V.getCourse(Number((m=B.params)==null?void 0:m.id),{additional:{chapters:!0}}),_.value=((o=s.value)==null?void 0:o.chapters)||[],delete s.value.chapters,(n=s.value)==null||delete n.author}catch{L.push({name:"course"})}});const N=async()=>{var o,n;const m=f.value[l.value];try{if(m.title.toLocaleLowerCase()==="details"&&s.value){const i=await((o=m.component)==null?void 0:o.validate());V.updateCourse(s.value.id,i)}if(m.title.toLocaleLowerCase()==="chapters"&&s.value){const i=await((n=m.component)==null?void 0:n.validate()),t=s.value.id,D=i.map((p,F)=>{const b={};return p.attachments.forEach(({name:T,id:E,type:R,download:A,visibility:U,watermark:z})=>{b[E]={name:T,type:R,download:A,visibility:JSON.stringify(U),watermark:z}}),{...p,course_id:t,attachments:b,order:F}});await Promise.all(D.map(p=>V.updateChapter(p.id||0,p))),g.add({text:"course updated successfuly",timeout:5e3})}}catch(i){g.add({text:i==null?void 0:i.message,color:"error",timeout:5e3})}};return(m,o)=>{const n=P,i=I;return c(),v(at,null,{default:a(()=>[e(X,{align:"center"},{default:a(()=>[e(y,{class:"d-flex gap-2 flex-wrap",style:{"flex-grow":"12 !important"}},{default:a(()=>[e(Z,{modelValue:r(l),"onUpdate:modelValue":o[0]||(o[0]=t=>h(l)?l.value=t:null),class:"v-tabs-pill"},{default:a(()=>[(c(!0),O(q,null,Y(r(f),t=>(c(),v(et,{key:t.icon},{default:a(()=>[e(k,{size:18,icon:t.icon,class:"me-1"},null,8,["icon"]),x("span",null,Q(t.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),r(l)===1?(c(),v(y,{key:0},{default:a(()=>[e(G,{modelValue:r(d),"onUpdate:modelValue":o[1]||(o[1]=t=>h(d)?d.value=t:null),divided:"",color:"primary",variant:"outlined",class:"mx-auto"},{default:a(()=>[e(C,{value:"list",icon:"mdi-list-box-outline"}),e(C,{value:"grid",icon:"mdi-grid-large"})]),_:1},8,["modelValue"])]),_:1})):w("",!0),e(y,{cols:"12"},{default:a(()=>[e(tt,{modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=t=>h(l)?l.value=t:null),class:"mt-5 overflow-visible"},{default:a(()=>[e(S,null,{default:a(()=>[e(n,{ref:t=>r(f)[0].component=t,course:r(s)},null,8,["course"])]),_:1}),e(S,null,{default:a(()=>[r(_)?(c(),v(i,{key:0,ref:t=>r(f)[1].component=t,"grid-type":r(d),chapters:r(_)},null,8,["grid-type","chapters"])):w("",!0)]),_:1})]),_:1},8,["modelValue"]),x("div",rt,[e(ot),e(C,{color:"success",onClick:N},{default:a(()=>[K(" Save "),e(k,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});export{le as default};
