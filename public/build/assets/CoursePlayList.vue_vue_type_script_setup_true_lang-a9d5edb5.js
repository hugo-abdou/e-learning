import{_ as B}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-5436e5d8.js";import{_ as A}from"./ActionButton-7996e9d4.js";import{_ as N}from"./ResponsiveText.vue_vue_type_script_setup_true_lang-fde6db9d.js";import{d as P,r as $,I as D,o,c as v,q as d,h as p,f as t,F as V,j as E,b as l,y as _,k as x,b_ as F,e as M,bm as j,c9 as q,z as m,a4 as I,ca as R,aU as U,c6 as G,V as H,v as J}from"./main-de81c04a.js";import{u as K}from"./useCourseStore-458c7fca.js";import{a as k,b,V as O,c as Q}from"./VList-2584110e.js";const W=!1,ae=P({__name:"CoursePlayList",props:{selected:{},courseId:{}},emits:["update:selected","play"],setup(C,{expose:w,emit:S}){const u=C,h=S,i=$([]),g=a=>{a&&i.value.forEach(s=>{s.type!=="header"&&s.index===a?(s.active=!0,h("update:selected",s)):s.active=!1})},L=()=>{var a,s;if(u.selected){let n=((a=u.selected)==null?void 0:a.index)+1;((s=i.value[n])==null?void 0:s.type)==="header"&&n++,g(n)}},T=()=>{},z=K();return D(async()=>{if(u.courseId)try{const{data:a}=await z.getChapters(u.courseId,{itemsPerPage:1e3});i.value=a.reduce((r,{attachments:n,title:y,id:e})=>(n.length&&(r.push({type:"header",title:y,id:e}),r.push(...n.map((c,f)=>({...c,index:f,active:f===0,chapter_id:e})))),r),[]);const s=i.value.find(r=>r.type==="video"&&r.active);h("update:selected",s)}catch{}}),w({next:L,prev:T}),(a,s)=>{const r=N,n=A,y=B;return o(),v("div",null,[d(i).length?(o(),p(O,{key:0,lines:"two",border:W},{default:t(()=>[(o(!0),v(V,null,E(d(i),e=>(o(),v(V,{key:e.id},[e.type!=="header"?(o(),p(k,{key:0,class:"mt-2",title:e.name,active:e.active,onClick:c=>g(e.index)},{prepend:t(({isActive:c})=>[M("div",null,[l(j,{style:{"aspect-ratio":"16/9","inline-size":"100px"},class:"rounded mr-2 bg-background border",src:e.thumb_url||d(q)(e),cover:""},null,8,["src"])])]),title:t(({title:c})=>[l(r,{text:String(c),"max-lines":2,"char-width":2},{default:t(({text:f})=>[_(m(f),1)]),_:2},1032,["text"])]),default:t(()=>[l(Q,{class:"d-flex gap-2 pa-1 align-center"},{default:t(()=>[l(I,{size:"16",icon:d(R)(e.type)},null,8,["icon"]),e.type==="video"?(o(),p(U,{key:0,size:"x-small"},{default:t(()=>[l(I,{icon:"mdi-clock-fast",size:"16",class:"mr-1"}),_(" "+m(d(G)(e.duration)),1)]),_:2},1024)):x("",!0),l(H),e.download?(o(),p(y,{key:1,text:"download"},{default:t(({props:c})=>[l(n,J({size:"x-small",icon:"mdi-download",download:"",href:e.path},c),null,16,["href"])]),_:2},1024)):x("",!0)]),_:2},1024)]),_:2},1032,["title","active","onClick"])):(o(),p(k,{key:1},{default:t(()=>[l(b,null,{default:t(()=>[_(m(a.$t("Chapter"))+" - "+m(e.title),1)]),_:2},1024)]),_:2},1024))],64))),128)),d(i).length?x("",!0):(o(),p(k,{key:0},{default:t(()=>[l(b,null,{default:t(()=>[_("Chapter empty")]),_:1})]),_:1}))]),_:1})):(o(),p(d(F),{key:1,type:Array(5).fill("list-item-avatar-three-line")},null,8,["type"]))])}}});export{ae as _};
