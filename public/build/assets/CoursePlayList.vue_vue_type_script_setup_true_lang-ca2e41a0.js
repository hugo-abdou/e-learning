import{_ as A}from"./InfoTooltip.vue_vue_type_script_setup_true_lang-0241b29a.js";import{_ as B}from"./ActionButton-88e06515.js";import{_ as N}from"./ResponsiveText.vue_vue_type_script_setup_true_lang-a0b04a89.js";import{t as P,r as $,k as D,H as d,v as r,z as p,A as t,x as g,y as E,F as h,n as l,aa as m,a2 as v,D as F,_ as M,E as _,C as I,bZ as H,s as R}from"./plugins-900eb03f.js";import{b as Z,c as j}from"./utils-01d7f181.js";import{u as q}from"./useCourseStore-eea862c2.js";import{a as x,b as C,V as G,c as J}from"./VList-ff1b2c79.js";import{V as K}from"./VSkeletonLoader-4cfb77ed.js";import{V as O}from"./VChip-b4e7b548.js";import{V as Q}from"./VSpacer-35711271.js";const le=P({__name:"CoursePlayList",props:{selected:{},courseId:{}},emits:["update:selected","play"],setup(b,{expose:w,emit:S}){const u=b,k=S,i=$([]),V=o=>{o>=0&&i.value.forEach(s=>{s.type!=="header"&&s.index===o?(s.active=!0,k("update:selected",s)):s.active=!1})},L=()=>{var o,s;if(u.selected){let n=((o=u.selected)==null?void 0:o.index)+1;((s=i.value[n])==null?void 0:s.type)==="header"&&n++,V(n)}},T=()=>{},z=q();return D(async()=>{if(u.courseId)try{const{data:o}=await z.getChapters(u.courseId,{itemsPerPage:1e3});i.value=o.reduce((a,{attachments:n,title:y,id:e})=>(n.length&&(a.push({type:"header",title:y,id:e}),a.push(...n.map((c,f)=>({...c,index:f,active:f===0,chapter_id:e})))),a),[]);const s=i.value.find(a=>a.type==="video"&&a.active);k("update:selected",s)}catch{}}),w({next:L,prev:T}),(o,s)=>{const a=N,n=B,y=A;return d(i).length?(r(),p(G,{key:0,lines:"two"},{default:t(()=>[(r(!0),g(h,null,E(d(i),e=>(r(),g(h,{key:e.id},[e.type!=="header"?(r(),p(x,{key:0,class:"mt-2",title:e.name,active:e.active,onClick:c=>V(e.index)},{prepend:t(({isActive:c})=>[F("div",null,[l(M,{style:{"aspect-ratio":"16/9","inline-size":"100px"},class:"rounded mr-2 bg-background border",src:e.thumb_url||d(Z)(e),cover:""},null,8,["src"])])]),title:t(({title:c})=>[l(a,{text:String(c),"max-lines":2,"char-width":2},{default:t(({text:f})=>[m(_(f),1)]),_:2},1032,["text"])]),default:t(()=>[l(J,{class:"d-flex gap-2 pa-1 align-center"},{default:t(()=>[l(I,{size:"16",icon:d(j)(e.type)},null,8,["icon"]),e.type==="video"?(r(),p(O,{key:0,size:"x-small"},{default:t(()=>[l(I,{icon:"mdi-clock-fast",size:"16",class:"mr-1"}),m(" "+_(d(H)(e.duration)),1)]),_:2},1024)):v("",!0),l(Q),e.download?(r(),p(y,{key:1,text:"download"},{default:t(({props:c})=>[l(n,R({size:"x-small",icon:"mdi-download",download:"",href:e.path},c),null,16,["href"])]),_:2},1024)):v("",!0)]),_:2},1024)]),_:2},1032,["title","active","onClick"])):(r(),p(x,{key:1},{default:t(()=>[l(C,null,{default:t(()=>[m(_(o.$t("Chapter"))+" - "+_(e.title),1)]),_:2},1024)]),_:2},1024))],64))),128)),d(i).length?v("",!0):(r(),p(x,{key:0},{default:t(()=>[l(C,null,{default:t(()=>[m("Chapter empty")]),_:1})]),_:1}))]),_:1})):(r(),p(d(K),{key:1,type:Array(5).fill("list-item-avatar-three-line")},null,8,["type"]))}}});export{le as _};
