import{_ as N}from"./CourseChaptersForm.vue_vue_type_script_setup_true_lang-69c9e806.js";import{_ as E}from"./CourseDetailsForm.vue_vue_type_script_setup_true_lang-c75b528d.js";import{u as R}from"./useCourseStore-3c100176.js";import{d as T,d3 as j,s as A,t as m,a7 as I,o as d,f as h,B as o,y as t,at as P,au as C,e as l,ak as w,i as U,F as W,j as $,ah as b,w as y,D as z,E as M,ai as q,as as G,a_ as k}from"./main-d3200a92.js";import{b as H,c as J,V as K,a as B}from"./VWindowItem-81ea1840.js";import{V as O}from"./VSpacer-92b60b12.js";import{V as Q}from"./VContainer-73328178.js";import"./FileUploaderDialog.vue_vue_type_script_setup_true_lang-98dad605.js";import"./GalleryView.vue_vue_type_script_setup_true_lang-f9c262fc.js";import"./utils-c92527c4.js";import"./VChip-a6de0ffd.js";import"./AppTextField.vue_vue_type_script_setup_true_lang-ea0dc63c.js";import"./VInput-a4774bed.js";import"./VTextField-ff3454b2.js";import"./VCheckbox-ac3ca1e2.js";import"./VCheckboxBtn-1b353d8a.js";import"./lodash-470102d3.js";import"./validators-f52bbb1d.js";import"./VExpansionPanel-9d02d201.js";import"./VForm-a28d883b.js";import"./AppSelect.vue_vue_type_script_setup_true_lang-6b856003.js";import"./VList-66bd46f3.js";import"./ssrBoot-4f9d510a.js";import"./VDivider-4e3adaff.js";import"./VMenu-fe26a8c9.js";import"./VSwitch-d926ecbf.js";import"./VSlideGroup-ce305fc4.js";const X={class:"d-flex justify-space-between mt-8"},Y=T({__name:"edit",setup(Z){const S=j(),g=A(),f=R(),n=m(0),p=m([{icon:"tabler-clipboard",title:"Details",subtitle:"Enter Coure Details",discription:"Provide data with this form to create your Coure",component:null},{icon:"grommet-icons:chapter-add",title:"Chapters",subtitle:"Add Chapters",discription:"Add Chapters",component:null}]),r=m(),_=m([]);I(async()=>{var s,a,i;try{r.value=await f.getCourse(Number(S.params.id),{additional:{chapters:!0}}),_.value=((s=r.value)==null?void 0:s.chapters)||[],(a=r.value)==null||delete a.chapters,(i=r.value)==null||delete i.author}catch{g.push({name:"course"})}});const x=async()=>{var a,i;const s=p.value[n.value];try{if(s.title.toLocaleLowerCase()==="details"&&r.value){const c=await((a=s.component)==null?void 0:a.validate());f.updateCourse(r.value.id,c)}if(s.title.toLocaleLowerCase()==="chapters"&&r.value){const c=await((i=s.component)==null?void 0:i.validate()),e=r.value.id,D=c.map((u,F)=>{var v;const V={};return u.attachments.forEach(({id:L})=>{V[L]={type:"media"}}),{...u,course_id:e,video:((v=u.video)==null?void 0:v.id)||null,attachments:V,order:F}});await Promise.all(D.map(u=>f.updateChapter(u.id,u)))}}catch{}};return(s,a)=>{const i=E,c=N;return d(),h(Q,null,{default:o(()=>[t(P,{align:"center"},{default:o(()=>[t(C,{cols:"12"},{default:o(()=>[t(H,{modelValue:l(n),"onUpdate:modelValue":a[0]||(a[0]=e=>w(n)?n.value=e:null),class:"v-tabs-pill"},{default:o(()=>[(d(!0),U(W,null,$(l(p),e=>(d(),h(J,{key:e.icon},{default:o(()=>[t(b,{size:18,icon:e.icon,class:"me-1"},null,8,["icon"]),y("span",null,z(e.title),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,{cols:"12"},{default:o(()=>[t(K,{modelValue:l(n),"onUpdate:modelValue":a[1]||(a[1]=e=>w(n)?n.value=e:null),class:"mt-5"},{default:o(()=>[t(B,null,{default:o(()=>[t(i,{course:l(r),ref:e=>l(p)[0].component=e},null,8,["course"])]),_:1}),t(B,null,{default:o(()=>[l(_)?(d(),h(c,{key:0,chapters:l(_),ref:e=>l(p)[1].component=e},null,8,["chapters"])):M("",!0)]),_:1})]),_:1},8,["modelValue"]),y("div",X,[t(O),t(q,{color:"success",onClick:x},{default:o(()=>[G(" Save "),t(b,{icon:"tabler-check",end:"",class:"flip-in-rtl"})]),_:1})])]),_:1})]),_:1})]),_:1})}}});typeof k=="function"&&k(Y);export{Y as default};
