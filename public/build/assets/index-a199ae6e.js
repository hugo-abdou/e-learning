import{_ as Z}from"./AppTextField.vue_vue_type_script_setup_true_lang-63897ad5.js";import{_ as ee}from"./AppSelect.vue_vue_type_script_setup_true_lang-e0cde11a.js";import{V as ae,r as le,p as te,a as se}from"./VPagination-0f1eec06.js";import{_ as oe}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-f18221d4.js";import{d as H,s as d,aw as K,I as Q,o as h,f as A,z as t,x as e,aH as G,aS as J,e as l,aj as b,aL as re,as as R,at as V,ah as $,ar as w,aT as ne,a5 as I,r as ie,g as F,v as _,C as c,aK as de,aR as ue,F as me,i as pe,ag as L,m as M,aU as j}from"./main-8c6cae95.js";import{u as W}from"./useUserListStore-0fc71ffb.js";import{r as S,e as fe}from"./validators-f52bbb1d.js";import{_ as X}from"./RolesSelectBox.vue_vue_type_script_setup_true_lang-c94ba213.js";import{V as ce}from"./VForm-ae6f6d49.js";import{V as O}from"./VTextField-41755040.js";import{a as ve}from"./formatters-3b7fec12.js";import{l as we}from"./lodash-bc5bedbb.js";import{V as z}from"./VDivider-4c3fc300.js";import{V as Ve}from"./VChip-bf88e46a.js";import{V as ge}from"./VMenu-ca74f75b.js";import{V as _e,a as E,b as q}from"./VList-04d013c6.js";import"./VInput-74f983d3.js";import"./VCheckboxBtn-cc4c4e9f.js";import"./VTable-18f30e34.js";import"./_commonjsHelpers-042e6b4d.js";const be=H({__name:"AddNewUserDrawer",props:{isDrawerOpen:{type:Boolean,default:!1},brand:null,disabledRoles:{type:Boolean},defaultRoles:null},emits:["update:isDrawerOpen","userData"],setup(T,{emit:y}){const p=T,f=d(!1),g=d(!1),C=d(!1),m=d(),U=d(""),x=d(""),s=d(""),D=d(),v=d({name:void 0,email:void 0,password:void 0}),N=()=>{I(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation(),v.value={name:void 0,email:void 0,password:void 0}})},P=()=>{y("update:isDrawerOpen",!1),k.refreshUser(),I(()=>{var r,n;(r=m.value)==null||r.reset(),(n=m.value)==null||n.resetValidation()})},B=W(),i=()=>{var r;g.value=!0,(r=m.value)==null||r.validate().then(async({valid:n})=>{if(n){try{const a=await B.addUser({name:U.value,email:x.value,password:s.value,password_confirmation:s.value,terms:!0});y("userData",a.data),y("update:isDrawerOpen",!1),N()}catch(a){a.response.status===422&&(v.value=a.response.data.errors)}g.value=!1}})},o=r=>{y("update:isDrawerOpen",r)},k=K();return Q(()=>p.isDrawerOpen,r=>{p.defaultRoles&&(D.value=p.defaultRoles)}),(r,n)=>{const a=oe;return h(),A(ne,{width:r.$vuetify.display.smAndDown?"auto":677,"model-value":p.isDrawerOpen,"onUpdate:modelValue":o},{default:t(()=>[e(a,{onClick:P}),e(G,{title:"Create New User",subtitle:"Created user details will receive a privacy audit."},{default:t(()=>[e(J,null,{default:t(()=>[e(ce,{ref_key:"refForm",ref:m,modelValue:l(C),"onUpdate:modelValue":n[5]||(n[5]=u=>b(C)?C.value=u:null),onSubmit:re(i,["prevent"])},{default:t(()=>[e(R,null,{default:t(()=>[e(V,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(U),"onUpdate:modelValue":n[0]||(n[0]=u=>b(U)?U.value=u:null),rules:[l(S)],label:"Full Name","error-messages":l(v).name},null,8,["modelValue","rules","error-messages"])]),_:1}),e(V,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(x),"onUpdate:modelValue":n[1]||(n[1]=u=>b(x)?x.value=u:null),rules:[l(S),l(fe)],label:"Email","error-messages":l(v).email},null,8,["modelValue","rules","error-messages"])]),_:1}),e(V,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:l(s),"onUpdate:modelValue":n[2]||(n[2]=u=>b(s)?s.value=u:null),label:"Password",rules:[l(S)],type:l(f)?"text":"password","append-inner-icon":l(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":n[3]||(n[3]=u=>f.value=!l(f)),"error-messages":l(v).password},null,8,["modelValue","rules","type","append-inner-icon","error-messages"])]),_:1}),e(V,{cols:"12",md:"6"},{default:t(()=>[e(X,{rules:[l(S)],modelValue:l(D),"onUpdate:modelValue":n[4]||(n[4]=u=>b(D)?D.value=u:null)},null,8,["rules","modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e($,{type:"submit",class:"me-3",loading:l(g),disabled:l(g)},{default:t(()=>[w(" Submit ")]),_:1},8,["loading","disabled"]),e($,{type:"reset",variant:"tonal",color:"secondary",onClick:P},{default:t(()=>[w(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}}),ye={class:"d-flex justify-end flex-wrap gap-4"},Ue={class:"d-flex align-center"},Pe={key:1},xe={class:"d-flex flex-column"},De={class:"text-base"},ke={class:"text-sm text-medium-emphasis"},he={class:"d-flex gap-1 py-2 flex-wrap w-100"},$e={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},Ce={class:"text-sm text-disabled mb-0"},Se=H({__name:"index",setup(T){const y=W(),p=d(""),f=d("all"),g=K(),C=d(1),m=d(0),U=d([]),x=d([]),s=d({page:1,itemsPerPage:10,sortBy:[],groupBy:[],search:void 0}),D=[{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Roles",key:"role",sortable:!1},{title:"",key:"actions",sortable:!1,width:"70"}],v=we.debounce(async()=>{var i,o,k;try{const r=await y.fetchUsers({q:p.value,role:f.value,...s.value});U.value=r.data,C.value=((i=r.meta)==null?void 0:i.to)||0,m.value=((o=r.meta)==null?void 0:o.total)||0,s.value.page=((k=r.meta)==null?void 0:k.current_page)||0}catch(r){console.log(r)}},500),N=()=>{v(),g.refreshUser()},P=d(!1),B=i=>{confirm("Are you sure you want to deactivate your account?")&&y.deleteUser(i).then(v)};return Q([s,p,f,()=>s.value.itemsPerPage],v),(i,o)=>{const k=ee,r=Z,n=ie("RouterLink");return h(),F("section",null,[e(R,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(G,{title:i.$t("Users")},{default:t(()=>[e(J,null,{default:t(()=>[e(R,{align:"end",justify:"space-between"},{default:t(()=>[e(V,{cols:"12",sm:"4"},{default:t(()=>[e(X,{"default-roles":l(x),modelValue:l(f),"onUpdate:modelValue":o[0]||(o[0]=a=>b(f)?f.value=a:null),label:i.$t("Select Role"),multiple:!1,clearable:""},null,8,["default-roles","modelValue","label"])]),_:1}),e(V,{cols:"12",sm:"4"},{default:t(()=>[e(k,{label:i.$t("Items Per Page"),"model-value":l(s).itemsPerPage,items:[10,20,50,100],"onUpdate:modelValue":o[1]||(o[1]=a=>l(s).itemsPerPage=parseInt(a,10))},null,8,["label","model-value"])]),_:1})]),_:1}),e(R,null,{default:t(()=>[e(V,{class:"d-flex gap-5"},{default:t(()=>[e(r,{modelValue:l(p),"onUpdate:modelValue":o[2]||(o[2]=a=>b(p)?p.value=a:null),placeholder:i.$t("Search"),density:"compact"},null,8,["modelValue","placeholder"]),_("div",ye,[e($,{"prepend-icon":"tabler-plus",onClick:o[3]||(o[3]=a=>P.value=!0)},{default:t(()=>[w(c(i.$t("Add New User")),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(z),e(l(ae),{"items-per-page":l(s).itemsPerPage,"onUpdate:itemsPerPage":o[5]||(o[5]=a=>l(s).itemsPerPage=a),page:l(s).page,"onUpdate:page":o[6]||(o[6]=a=>l(s).page=a),items:l(U),"items-length":l(m),headers:D.map(a=>({...a,title:i.$t(a.title)})),class:"text-no-wrap","onUpdate:options":o[7]||(o[7]=a=>s.value=a)},{"item.name":t(({item:a})=>[_("div",Ue,[e(de,{size:"34",variant:a.raw.avatar?void 0:"tonal",class:"me-3",color:a.raw.avatar?void 0:l(le)(a.raw.role).color},{default:t(()=>[a.raw.avatar?(h(),A(ue,{key:0,src:a.raw.avatar},null,8,["src"])):(h(),F("span",Pe,c(l(ve)(a.raw.name)),1))]),_:2},1032,["variant","color"]),_("div",xe,[_("h6",De,[e(n,{to:l(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}},class:"font-weight-medium user-list-name"},{default:t(()=>[w(c(a.raw.name),1)]),_:2},1032,["to"])]),_("span",ke,c(a.raw.email),1)])])]),"item.role":t(({item:a})=>[_("div",he,[(h(!0),F(me,null,pe(a.raw.role,(u,Y)=>(h(),A(Ve,{label:"",size:"small",color:"default",density:"comfortable",key:Y},{default:t(()=>[w(c(u),1)]),_:2},1024))),128))])]),"item.actions":t(({item:a})=>[e($,{icon:"",variant:"text",size:"small",color:"medium-emphasis"},{default:t(()=>[e(L,{size:"24",icon:"tabler-dots-vertical"}),e(ge,{activator:"parent"},{default:t(()=>[e(_e,null,{default:t(()=>[e(E,{to:l(g).user.id===a.raw.id?{name:"account-settings-tab",params:{tab:"account"}}:{name:"users-id",params:{id:a.raw.id}}},{prepend:t(()=>[e(L,{icon:"tabler-eye"})]),default:t(()=>[e(q,null,{default:t(()=>[w(c(i.$t("View")),1)]),_:1})]),_:2},1032,["to"]),e(E,{onClick:u=>B(a.raw.id)},{prepend:t(()=>[e(L,{icon:"tabler-trash"})]),default:t(()=>[e(q,null,{default:t(()=>[w(c(i.$t("Delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[e(z),_("div",$e,[_("p",Ce,c(l(te)(l(s),l(m))),1),e(se,{"model-value":l(s).page,"onUpdate:modelValue":o[4]||(o[4]=a=>s.value={...l(s),page:a}),length:Math.ceil(l(m)/l(s).itemsPerPage),"total-visible":i.$vuetify.display.xs?1:Math.ceil(l(m)/l(s).itemsPerPage)},{prev:t(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:t(()=>[w(c(i.$t("Previous")),1)]),_:2},1040)]),next:t(a=>[e($,M({variant:"tonal",color:"default"},a,{icon:!1}),{default:t(()=>[w(c(i.$t("Next")),1)]),_:2},1040)]),_:1},8,["model-value","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length","headers"])]),_:1},8,["title"]),e(be,{"default-roles":["user"],isDrawerOpen:l(P),"onUpdate:isDrawerOpen":o[8]||(o[8]=a=>b(P)?P.value=a:null),onUserData:N},null,8,["isDrawerOpen"])]),_:1})]),_:1})])}}});typeof j=="function"&&j(Se);export{Se as default};
